{include(/ru/_includes/_dp_mpl_user_warn.md)}

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где нужно создать экземпляр сервиса.
1. Перейдите в раздел **Data Platform → Экземпляры сервисов**.
1. Нажмите кнопку **Создать экземпляр**.
1. На шаге **Конфигурация**:

   1. Выберите тип сервиса `Cloud Kafka`.
   1. Выберите нужную версию сервиса.
   1. Выберите конфигурацию экземпляра сервиса:

      - `Одиночный узел`: конфигурация из одного узла, не отказоустойчивая. Экземпляр в такой конфигурации подходит для задач разработки и тестирования.
      - `Кластер`: отказоустойчивая конфигурация из нескольких узлов. Экземпляр в такой конфигурации подходит для любых задач, в том числе для повседневной работы с данными в production-среде.

   1. Нажмите кнопку **Следующий шаг**.

1. На шаге **Параметры**:

   1. Задайте для экземпляра название и описание.
   1. Включите параметр **Назначить внешний IP**, если требуется доступ к экземпляру из внешней сети.
   1. Выберите **Кластер Kubernetes**. В этот кластер [Cloud Containers](/ru/kubernetes/k8s) будет добавлен [worker-узел](/ru/kubernetes/k8s/concepts/architecture#cluster_topology) для размещения экземпляра Cloud Kafka.

      Если нужного кластера нет в списке:

      1. Выберите пункт `Создать новый кластер`.
      1. Выберите сеть и подсеть для кластера из выпадающего списка **Сеть**.

         Если нужной сети нет в списке, выберите пункт `Создать`.

   1. Выберите [зону доступности](/ru/start/concepts/architecture#az), где будет размещен узел кластера Cloud Containers.
   1. Настройте параметры узлов кластера, выбрав одну из опций:

      {tabs}
      
      {tab(Базовая)}
            
      В зависимости от выбранной конфигурации преднастроенные ресурсы будут иметь разное количество узлов:

         - в конфигурации экземпляра `Одиночный узел` — 1 узел брокера Kafka;
         - в конфигурации экземпляра `Кластер` — 3 узла брокера Kafka.

      {/tab}
      
      {tab(Продвинутая)}
      
      Настройте параметры самостоятельно:

      1. В блоке **Kafka брокер** укажите:
      
         - Количество узлов брокера Kafka и их параметры: количество CPU, объем RAM, [тип](/ru/computing/iaas/concepts/data-storage/disk-types#disk_types) и размер диска.

            Для создания отказоустойчивого кластера количество узлов должно быть больше чем `1`.

         - Протокол безопасности **security.protocol**, который будет использоваться для аутентификации в Cloud Kafka:

            - `ALL` — с шифрованием соединения и с помощью SSL/TLS, и без него.
            - `SASL_SSL` —  только с шифрованием соединения с помощью SSL/TLS.
            - `SASL_PLAINTEXT` — только без шифрования соединения. Данные передаются в открытом виде.

      1. (Опционально) Выберите и настройте дополнительные компоненты. Для этого включите опцию **Установить** и укажите количество CPU и объем RAM. Доступны следующие опции:

         - Для работы с Cloud Kafka через REST API установите **Kafka Bridge**.

         - Для работы с Cloud Kafka через графический интерфейс установите **Kafka UI**.         

      {/tab}
      
      {/tabs}

   1. Нажмите кнопку **Следующий шаг**.

1. На шаге **Обслуживание**:

   1. Выберите дни недели и время начала проведения технических работ. В это время на сервере могут выполняться технические работы, в том числе создание резервных копий — сервис может быть временно недоступен.

      {note:info}

      Длительность технических работ — 4 часа. Временная зона — GMT+03:00. 
      
      {/note}
      
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге **Учетные данные**:

   1. Задайте логин учетной записи для доступа к Kafka.
   1. Выберите роль:

      - `Владелец кластера` — имеет полный контроль над сообщениями, анализом, транзакциями и настройками, а также может создавать, изменять, удалять и просматривать все объекты (топики, схемы, группы, коннекторы, конфигурации).
      - `Стандартный пользователь` — может создавать и изменять топики, схемы, группы, коннекторы, а также читать и писать сообщения. Не может удалять объекты, запускать анализ и управлять конфигурациями.
      - `Наблюдатель` — может только просматривать топики, схемы, группы, коннекторы и читать сообщения. Не может создавать, изменять или удалять объекты.
      - `Аудитор безопасности` — может просматривать конфигурации приложений, кластеров, ACL, а также описания топиков, групп, транзакций и пользователей. Не имеет доступа к сообщениям и операциям с объектами.

      {note:info}

      Управление пользователями доступно только через личный кабинет VK Cloud.

      {/note}

      Для Cloud Kafka можно создать несколько пользователей, но как минимум один из них должен быть с ролью `Владелец кластера`.

   1. Придумайте или сгенерируйте пароль администратора.

      Требования к паролю:

      - может содержать только цифры, символы `!`, `"`, `#`, `$`, `%`, `&`, `(`, `)`, `*`, `+`, `,`, `.`, `:`, `;`, `<`, `=`, `>`, `?`, `@`, `[`, `]`, `^`, `_`, `{`, `|`, `}`, `~`, `-`, заглавные и строчные латинские буквы;
      - должен состоять как минимум из 8 символов;
      - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

      {note:err}

      Восстановить пароль нельзя.

      {/note}

   1. (Опционально) Чтобы добавить дополнительных пользователей, нажмите **Добавить учетную запись**.

   1. Нажмите кнопку **Создать**.

      Дождитесь завершения операции. Создание экземпляра Cloud Kafka может занять длительное время.

{/tab}

{/tabs}


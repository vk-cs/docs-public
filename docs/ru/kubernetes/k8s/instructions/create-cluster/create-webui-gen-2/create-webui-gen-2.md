Далее описывается создание кластера Kubernetes второго поколения из личного кабинета. Для кластеров второго поколения включена интеграция с сервисом [мониторинга VK Cloud](/ru/monitoring-services/monitoring), отключить ее нельзя.

{note:warn}

При создании кластера для него будет создан [сервисный балансировщик нагрузки](/ru/networks/balancing/concepts/load-balancer#tipy_balansirovshchikov_nagruzki). Использование балансировщика [тарифицируется](/ru/networks/vnet/tariffication).

{/note}

## Перед созданием кластера

1. Ознакомьтесь с доступными ресурсами и [квотами](/ru/tools-for-using-services/account/concepts/quotasandlimits#k8s) для [региона](/ru/tools-for-using-services/account/concepts/regions), в котором планируется создать кластер. Для разных регионов могут быть настроены разные квоты.

   Если вы хотите увеличить квоты, напишите в [техническую поддержку](/ru/contacts).

1. Убедитесь, что для вашего проекта подключена [SDN Sprut](/ru/networks/vnet/concepts/sdn#sprut). В противном случае обратитесь в техническую поддержку c запросом на подключение.

1. Запустите мастер создания кластера:

   1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
   1. Выберите [проект](/ru/tools-for-using-services/account/concepts/projects), в котором будет размещен кластер.
   1. Перейдите в раздел **Контейнеры** → **Кластеры Kubernetes**.
   1. Нажмите кнопку **Добавить** или **Создать кластер**, если в проекте еще не создано ни одного кластера.
   1. Выберите опцию **Новое поколение** и нажмите кнопку **Продолжить**.

## Настройте кластер

1. В блоке **Конфигурация** задайте [версию Kubernetes](/ru/kubernetes/k8s/concepts/versions/version-support) для кластера.

1. Нажмите кнопку **Настроить** в блоке **Мастер узлы** и задайте основные настройки кластера:

   - **Имя кластера**: должно начинаться с буквы. Может состоять только из латинских строчных букв, цифр и дефисов `-` в качестве разделителя.

   - **Тип кластера**:

      - **Стандартный**: все master-узлы кластера будут располагаться в одной [зоне доступности](/ru/start/concepts/architecture#az). Отказоустойчивость обеспечивается на уровне зоны.
      - **Отказоустойчивый**: master-узлы кластера будут располагаться в каждой из трех зон доступности, что позволяет сохранить управление при отказе одной из зон. Общее количество master-узлов — 3 или 5.

   - **Количество узлов Master**: выберите `1`, `3` или `5` в зависимости от того, насколько отказоустойчивый кластер вы хотите создать. Рекомендуется создавать кластеры с тремя или пятью master-узлами, так как один узел не обеспечивает отказоустойчивость кластера на уровне master-узлов. Для отказоустойчивых кластеров автоматически выбрано значение `3`, но его можно увеличить до `5`.

     Управление master-узлами происходит на стороне платформы VK Cloud, поэтому остальные настройки для них устанавливаются автоматически. Подробнее о топологиях и возможных конфигурациях кластера в разделе [Архитектура сервиса](../../../concepts/architecture#cluster_topology).

   - **Зона доступности**: выберите [зону доступности](/ru/start/concepts/architecture#az) для узлов. Для отказоустойчивых кластеров автоматически выбраны все три зоны доступности, изменить выбор нельзя.

1. Нажмите кнопку **Настроить** в блоке **Сеть и настройки** и задайте настройки сети:

   - **Сеть**: выберите сеть и подсеть кластера, куда будет подключен балансировщик и worker-узлы кластера. Если нужных сети и подсети нет в списке, [создайте](/ru/networks/vnet/instructions/net#sozdanie_seti) их.
       
   - **Использовать сеть Load Balancer**: включите эту опцию, чтобы для создаваемых кластером балансировщиков нагрузки использовалась отдельная подсеть в выбранной сети. Если нужной подсети нет в списке, [создайте](/ru/networks/vnet/instructions/net#sozdanie_podseti) ее.
     
      По умолчанию опция отключена, и балансировщики нагрузки используют ту же подсеть, что и узлы кластера.

   - **Подсеть пода**: задайте подсеть, которую будут использовать поды для коммуникации между собой.

      По умолчанию поды используют подсеть `10.100.0.0./16`. Если такая подсеть уже существует в сети кластера, задайте другую подсеть, не входящую в сеть кластера. Это необходимо, чтобы не было пересечений адресного пространства.

   - **Назначить внешний IP**: включите эту опцию, чтобы API-эндпоинту кластера были назначены внешние IP-адреса. В противном случае IP-адреса будут назначены из подсети кластера.

      По умолчанию опция включена, что позволяет получить доступ к кластеру из интернета.

1. Нажмите кнопку **Настроить** в блоке **Группы узлов** и задайте [настройки](../../helpers/node-group-settings) для группы worker-узлов.

   1. (Опционально) Добавьте еще одну или несколько групп worker-узлов, нажав кнопку **Добавить группу узлов**, и [настройте](../../helpers/node-group-settings) их.

   1. (Опционально) Удалите ненужные группы узлов, нажав кнопку **Удалить группу узлов** в соответствующей группе.

1. Нажмите кнопку **Создать**.

   Начнется создание кластера Kubernetes. Этот процесс может занять длительное время, в зависимости от размеров кластера. 

   После создания кластера будет автоматически скачан его [конфигурационный файл](https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/) (kubeconfig) с именем в формате `<ИМЯ_КЛАСТЕРА>_kubeconfig.yaml`. Этот файл понадобится для [подключения](/ru/kubernetes/k8s/connect) к кластеру.

## Что дальше?

- [Настройте окружение](../../../connect) на хосте, с которого планируется подключаться к кластеру.
- [Познакомьтесь со сценариями использования](../../../how-to-guides) кластера.
- [Познакомьтесь с концепциями](../../../concepts) сервиса Cloud Containers.

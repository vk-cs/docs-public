Маршрутизатор направляет трафик между подсетями, учитывая топологию сети и заданные правила маршрутизации. В VK Cloud маршрутизаторы обеспечивают:

- связность между внутренними подсетями;
- доступ к внешним сетям (включая интернет);
- интеграцию с удаленными площадками через VPN или выделенные каналы.

{note:info}

[Группы безопасности](../traffic-limiting) (файервол) влияют на возможность обмена трафиком поверх правил маршрутизации. В статье предполагается, что файервол пропускает весь трафик.

{/note}

Типы маршрутизаторов в VK Cloud:

- стандартный маршрутизатор;
- продвинутый маршрутизатор.

В одной подсети VK Cloud можно использовать разные типы маршрутизаторов.

{note:info}

Внешний IP-адрес можно привязать к виртуальным машинам независимо от того, какой тип маршрутизатора используется в их подсети.

{/note}

## {heading(Стандартный маршрутизатор)[id=standard]}

*Стандартный маршрутизатор* используется для объединения подсетей в проекте и для предоставления доступа к ресурсам в подсети из интернета. На основе стандартного маршрутизатора можно создать VPN-подключение к удаленным сетям для проектов с [SDN Neutron](../../concepts/sdn#neutron).

Основные функции:

- Маршрутизация трафика между подсетями VK Cloud.
- Предоставление доступа в интернет.
- Поддержка базовых VPN-туннелей для подключения к удаленным сетям.

Особенности:

- Использует порт INTERFACE_DISTRIBUTED как шлюз по умолчанию.
- Поддерживает статическую маршрутизацию (например, для перенаправления трафика через виртуальный файервол).
- Предоставляет доступ в интернет через SNAT ([Source NAT](https://docs.openstack.org/neutron/2023.2/admin/intro-nat.html#snat)) и Floating IP-адреса ([1-to-1 NAT](https://docs.openstack.org/neutron/2023.2/admin/intro-nat.html#one-to-one-nat)).

## {heading(Продвинутый маршрутизатор)[id=advanced]}

*Продвинутый маршрутизатор* используется для [интеграции](../onpremise-connect) облачной инфраструктуры с корпоративными сетями, в том числе через выделенный канал и BGP-маршрутизацию. На основе продвинутого маршрутизатора можно построить распределенную отказоустойчивую инфраструктуру с резервированием каналов связи.

Основные функции:

- Подключение к удаленным сетям через [Cloud Direct Connect](../../../directconnect) и VPN-туннель.
- Динамическая маршрутизация с использованием BGP-протокола.
- Обеспечение отказоустойчивости через VRRP-протокол (Virtual Router Redundancy Protocol).

Особенности:

- Доступен только в [SDN Sprut](../../concepts/sdn#sprut).
- Работает с любыми типами сетей: стандартная, внешняя, сеть Cloud Direct Connect (сетевой стык).
- Может использовать как динамическую, так и статическую маршрутизацию.
- В SDN Sprut для построения VPN-подключений используется только продвинутый маршрутизатор.

При организации BGP-пиринга (BGP peering) между продвинутым маршрутизатором и удаленным маршрутизатором на площадке действуют следующие правила:

- BGP-пиринг должен выполняться поверх сети Cloud Direct Connect.
- Допустимо использовать только приватные номера автономных систем (Autonomous System Number, ASN) из диапазона `64512`–`65534`.
- Со стороны и продвинутого, и удаленного маршрутизатора допустимо анонсировать только префиксы приватных подсетей, которые не маршрутизируются в интернете.

Также на стороне продвинутого маршрутизатора заданы следующие значения [таймеров BGP](https://www.rfc-editor.org/rfc/rfc4271#page-90):

- Hold-таймер: 240 секунд.
- Keepalive-таймер: 80 секунд (`hold-таймер` / `3`).

{note:warn}

Несовпадение значений этих таймеров для BGP-маршрутизаторов не влияет на установку отношений соседства (neighbor relationships) между ними.

{/note}

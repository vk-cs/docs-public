Вы можете управлять балансировщиками нагрузки: просматривать, редактировать и удалять их, добавлять и изменять правила балансировки, манипулировать публичными IP-адресами.

## Просмотр списка балансировщиков нагрузки и информации о них

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.

   Будет отображен список балансировщиков.

1. Нажмите на имя нужного балансировщика.

   Откроется страница с подробной информацией о нем. На этой странице можно также [редактировать](#redaktirovanie_imeni_balansirovshchika_nagruzki) параметры балансировщика.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. Чтобы посмотреть список балансировщиков нагрузки и их идентификаторы, выполните команду:

   ```console
   openstack loadbalancer list
   ```

1. Чтобы посмотреть детальную информацию о балансировщике нагрузки, выполните команду:

   ```console
   openstack loadbalancer show <ID_БАЛАНСИРОВЩИКА>
   ```

   Будет выведена общая информация о балансировщике нагрузки и идентификаторы:

   - `vip_port_id` — идентификатор порта, который используется в качестве виртуального IP-адреса на балансировщике нагрузки. На этот порт можно назначить Floating IP-адрес.

   - `listeners` — список идентификаторов прослушивателей (listener). Эти объекты слушают входящие соединения к балансировщику нагрузки и служат точкой входа для трафика.

   - `pools` — список идентификаторов пулов (pools). Эти объекты служат для группировки конечных потребителей трафика. Потребители выступают участниками (members) пула. Трафик от прослушивателей балансируется между несколькими участниками, входящими в пул, сконфигурированный для прослушивателя.

1. Чтобы посмотреть настройки прослушивателей и их связь с пулами, выполните команду:

   ```console
   openstack loadbalancer listener show <ID_ПРОСЛУШИВАТЕЛЯ>
   ```

1. Чтобы посмотреть настройки пула и список участников этого пула, выполните команду:

   ```console
   openstack loadbalancer pool show <ID_ПУЛА>
   ```

1. Чтобы посмотреть настройки отдельного участника из пула, выполните команду:

   ```console
   openstack loadbalancer member show <ID_ПУЛА> <ID_УЧАСТНИКА>
   ```

   Для участника будет выведена информация, в том числе порт назначения трафика.

{/tab}

{/tabs}

## Добавление балансировщика нагрузки

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.
1. Нажмите кнопку **Добавить балансировщик** или **Добавить**.
1. Задайте параметры балансировщика:

   - **Название балансировщика**.
   - **Сеть**: сеть и подсеть, в которой будет размещаться балансировщик.

     Балансировщик будет распределять входящий трафик на выбранные сервисы, которые размещены в этой подсети.

     {note:warn}

     Изменить этот параметр позднее невозможно.

     {/note}

   - **Зона доступности**: выберите [зону доступности](/ru/intro/start/concepts/architecture#az) в списке. Для оптимизации и ускорения подключения ВМ к балансировщику размещайте их в одной зоне.
   - **DNS-имя**: (опционально) DNS-имя для балансировщика.
   - **Назначить внешний IP**: если эта опция выбрана, то балансировщику будет назначен публичный IP-адрес, через который он будет доступен из интернета. В противном случае балансировщик будет выступать в качестве внутреннего балансировщика нагрузки. Такой IP-адрес можно [назначить позднее](#upravlenie_publichnymi_ip_adresami).

     Выберите эту опцию, если планируется размещать за балансировщиком сервисы, которые должны быть доступны из интернета.
     Опцию можно выбрать только при условии, что сеть, выбранная ранее, находится за маршрутизатором, который имеет доступ в интернет.

1. Задайте правила балансировки.
1. Нажмите кнопку **Добавить балансировщик**.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. Выберите сеть и подсеть, в которых будет размещен балансировщик. [Получите идентификатор](../../../vnet/instructions/net#prosmotr_spiska_setey_i_podsetey_a_takzhe_informacii_o_nih) подсети.

1. Выберите [зону доступности](/ru/intro/start/concepts/architecture#az), в которой будет размещен балансировщик. Чтобы получить список зон доступности, используйте команду:

   ```console
   openstack availability zone list
   ```

   Для оптимизации и ускорения подключения ВМ к балансировщику размещайте их в одной зоне доступности.

1. Создайте балансировщик:

   ```console
   openstack loadbalancer create --name <ИМЯ_БАЛАНСИРОВЩИКА> --vip-subnet-id <ID_ПОДСЕТИ> --availability-zone <ЗОНА_ДОСТУПНОСТИ>
   ```

1. (Опционально) [Назначьте балансировщику внешний IP-адрес](#upravlenie_publichnymi_ip_adresami). Через этот адрес он будет доступен из интернета. В противном случае балансировщик будет выступать в качестве внутреннего балансировщика нагрузки.

   Адрес требуется назначить, если планируется размещать за балансировщиком сервисы, которые должны быть доступны из интернета. Назначить адрес можно только при условии, что сеть для подсети, выбранной ранее, находится за маршрутизатором, который имеет доступ в интернет.

{/tab}

{/tabs}

## Редактирование имени балансировщика нагрузки

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.
1. Выполните одно из действий для балансировщика, который нужно отредактировать:

   - Нажмите на имя балансировщика.
   - Нажмите ![ ](/ru/assets/more-icon.svg "inline") для балансировщика и выберите пункт **Редактировать**.

   Откроется страница с подробной информацией о балансировщике.

1. Чтобы изменить имя:

   1. Нажмите на значок карандаша рядом с текущим именем балансирощика.
   1. Задайте новое имя.
   1. Нажмите кнопку **Переименовать**.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. [Получите идентификатор](#prosmotr_spiska_balansirovshchikov_nagruzki_i_informacii_o_nih) нужного балансировщика нагрузки.

1. Измените имя балансировщика:

   {tabs}
   
   {tab(Linux/macOS (bash, zsh))}

   ```console
   openstack loadbalancer <ID_БАЛАНСИРОВЩИКА> \
     --name <НОВОЕ_ИМЯ>
   ```

   {/tab}
   
   {tab(Windows (PowerShell))}

   ```console
   openstack loadbalancer <ID_БАЛАНСИРОВЩИКА> `
     --name <НОВОЕ_ИМЯ>
   ```

   {/tab}
   
   {/tabs}

{/tab}

{/tabs}

## Управление публичными IP-адресами

### Назначить публичный IP-адрес

Если сеть балансировщика подключена к маршрутизатору с доступом в интернет, то можно назначить балансировщику публичный (внешний) IP-адрес.

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.
1. Выполните одно из действий:

   - Нажмите на имя нужного балансировщика.

     На странице с подробной информацией о балансировщике нажмите ссылку **Назначить** в блоке **IP-адреса** → **Внешний**.

   - Нажмите ![ ](/ru/assets/more-icon.svg "inline") для нужного балансировщика и выберите пункт **Назначить внешний IP**.

1. Выберите нужный публичный IP-адрес из списка либо создайте новый.
1. Нажмите кнопку **Подтвердить**.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. [Получите идентификатор порта](../../../vnet/instructions/ports#prosmotr_spiska_portov_i_informacii_o_nih) с Virtual IP для нужного балансировщика нагрузки.
1. [Привяжите Floating IP-адрес](../../../vnet/instructions/ip/floating-ip#associate) к порту с этим идентификатором.

{/tab}

{/tabs}

### Отвязать публичный IP-адрес

Если сеть балансировщика подключена к маршрутизатору с доступом в интернет, и балансировщику назначен публичный (внешний) IP-адрес, то этот адрес можно отвязать.

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.
1. Выполните одно из действий:

   - Нажмите на имя нужного балансировщика.

     На странице с подробной информацией о балансировщике нажмите символ **x** рядом с IP-адресом в секции **IP-адреса** → **Внешний**.

   - Нажмите ![ ](/ru/assets/more-icon.svg "inline") для нужного балансировщика и выберите пункт **Отвязать внешний IP**.

1. Нажмите кнопку **Подтвердить**.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. [Получите идентификатор порта](../../../vnet/instructions/ports#prosmotr_spiska_portov_i_informacii_o_nih) с Virtual IP для нужного балансировщика нагрузки.
1. [Отвяжите Floating IP-адрес](../../../vnet/instructions/ip/floating-ip#disassociate) от порта с этим идентификатором.

{/tab}

{/tabs}

## Управление правилами балансировки

{tabs}

{tab(Личный кабинет)}

1. [Перейдите](#prosmotr_spiska_balansirovshchikov_nagruzki_i_informacii_o_nih) на страницу балансировщика для его редактирования.
1. В секции **Правила балансировки** выполните одно из доступных действий:

   1. Добавьте правило балансировки.
   1. Отредактируйте существующее правило балансировки, нажав на значок карандаша рядом с правилом.
   1. Удалите существующее правило балансировки, нажав на значок корзины рядом с правилом.

При добавлении или редактировании правила доступны следующие параметры:

1. Параметры правила:

   - **Протоколы и порты** (только при создании правила):

     - Протокол балансировки и порт, который будет использоваться балансировщиком.
     - Протокол и порт назначения.

     При выборе протокола балансировки `TCP` доступны два протокола назначения: `TCP` или `PROXY`. Proxy-протокол можно использовать, если он поддерживается серверами, которые находятся за балансировщиком.

   - **Метод балансировки**:

     - `LEAST_CONNECTIONS`: использовать бэкенд, к которому установлено наименьшее число соединений.
     - `ROUND_ROBIN`: перебирать последовательно все бэкенды.
     - `SOURCE_IP`: закреплять бэкенд для обработки трафика за конкретным IP-адресом клиента.

   - **Разрешенные CIDR**: IP-адреса или адреса подсетей, с которых разрешены подключения к балансировщику. Этот параметр может использоваться для ограничения доступа к балансировщику только с доверенных адресов.

     Если параметр не задан, то разрешено подключение с любых IP-адресов (что эквивалентно CIDR `0.0.0.0/0`).

   - **Timeout параметры**:

     - `Client data`: тайм-аут неактивности клиента.
     - `Member connect`: тайм-аут установки соединения с бэкендом.
     - `Member data`: тайм-аут неактивности бэкенда.
     - `TCP inspect`: тайм-аут ожидания дополнительных TCP-сегментов при инспекции контента.

     Значения тайм-аутов задаются в миллисекундах. Минимальное значение — `0`, максимальное — `2073600000` (576 часов).

   - **Отправлять заголовок X-Forwarded-For** (только для протоколов балансировки HTTP и HTTPS): опция, позволяющая включить отправку на бэкенд соответствующего HTTP-заголовка. По умолчанию опция выключена.

   - **Sticky sessions**: опция обеспечивает длительные сессии соединения с сервером c сохранением данных на протяжении всей сессии.

     Если опция включена, запросы распределяются между серверами по выбранному методу балансировки, но после соединения сессия закрепляется за выбранным сервером. Все последующие запросы этой сессии будут направляться на тот же сервер без учета метода балансировки. Сессия не прекращается, пока пользователь сам не завершит ее или пока сервер не станет недоступным. В таком случае запросы будут отправляться к другому серверу по правилам балансировки.

     Поле **Тип** позволяет настроить определение сессии:

      - **по APP-cookie**:  сессия определяется по cookie, заданной в коде приложения. Если выбран этот параметр, в поле **Cookie name** укажите cookie, по которой определяется сессия.
      - **по HTTP-cookie**: сессия определяется по cookie, которую балансировщик нагрузки создает во время соединения с сервером и прикрепляет к сессии.
      - **по Source IP**: для привязки сессии к серверу используется IP-адрес клиента. Используйте этот тип только если IP-адрес клиента не изменяется за время сессии.

   - **Применить для следующих инстансов**: инструменты для выбора инстансов виртуальных машин, которые будут выступать бэкендами для балансировщика. Можно добавить инстанс либо выбрав его из списка, либо выбрав тег, назначенный инстансу.

     {note:info}

     Группы безопасности для выбранных виртуальных машин должны быть настроены так, чтобы разрешать трафик на порт и протокол назначения.

     {/note}

   - **Сертификат** (только для протокола балансировки HTTPS): сертификат, который будет использоваться балансировщиком для терминирования SSL-соединения.

     Можно выбрать уже существующий сертификат или загрузить новый.

     При загрузке нового сертификата указываются:

     - **Название сертификата**.
     - **Сертификат или цепочка сертификатов**: публичный сертификат или цепочка сертификатов. Можно вставить в поле в текстовом виде или загрузить из файла.
     - **Приватный ключ**: приватный сертификат. Можно вставить в поле в текстовом виде или загрузить из файла.
     - **Пароль**: пароль от приватного сертификата (если используется). Можно вставить в поле в текстовом виде или загрузить из файла.

1. Параметры проверки доступности бэкендов (healthcheck):

   - **Тип проверки**: TCP или HTTP.
   - **Интервал**: интервал проверки в секундах.
   - **Кол-во попыток**: сколько раз попытаться провести проверку, прежде чем признавать бэкенд недоступным.
   - **Таймаут**: тайм-аут в секундах, после истечения которого считается, что бэкенд не отвечает на проверку.

   Следующие параметры доступны только для типа проверки `HTTP`:

   - **HTTP-метод**: метод, который надо использовать для проверки доступности.
   - **Статус ответа**: [HTTP-статус](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status), при получении которого проверка доступности будет считаться успешной.
   - **Путь запроса**: путь, по которому надо обратиться для проверки доступности.

{/tab}

{tab(OpenStack CLI)}

{note:info}

Здесь приведены только основные аргументы команд. Подробнее о командах и их аргументах читайте в справке OpenStack CLI:

```console
openstack loadbalancer --help
openstack loadbalancer <КОМАНДА> --help
```

{/note}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. Чтобы создать правило балансировки:

   1. [Получите идентификатор балансировщика нагрузки](#prosmotr_spiska_balansirovshchikov_nagruzki_i_informacii_o_nih), для которого нужно создать правило.

   1. Создайте пул, в котором будут размещены потребители трафика:

      {tabs}
      
      {tab(Linux/macOS (bash, zsh))}
            
      ```console
      openstack loadbalancer pool create \
        --loadbalancer <ID_БАЛАНСИРОВЩИКА> \
        --name <ИМЯ_ПУЛА> \
        --protocol <ПРОТОКОЛ_НАЗНАЧЕНИЯ> \
        --lb-algorithm <АЛГОРИТМ_БАЛАНСИРОВКИ>
      ```

      {/tab}
      
      {tab(Windows (PowerShell))}
      
      ```console
      openstack loadbalancer pool create `
        --loadbalancer <ID_БАЛАНСИРОВЩИКА> `
        --name <ИМЯ_ПУЛА> `
        --protocol <ПРОТОКОЛ_НАЗНАЧЕНИЯ> `
        --lb-algorithm <АЛГОРИТМ_БАЛАНСИРОВКИ>
      ```

      {/tab}

      {/tabs}

      Запишите идентификатор созданного пула (`id`).

   1. Определите IP-адреса виртуальных машин, которые будут участниками (members) пула. Также [определите идентификатор](../../../vnet/instructions/net#prosmotr_spiska_setey_i_podsetey_a_takzhe_informacii_o_nih) подсети, в которой находятся виртуальные машины.

      Эти виртуальные машины должны быть либо размещены в подсети, где находится балансировщик, для которого создается правило балансировки, либо доступны из этой подсети.

   1. Для каждой такой виртуальной машины создайте member-объект, который будет участником созданного пула:

      {tabs}
      
      {tab(Linux/macOS (bash, zsh))}
            
      ```console
      openstack loadbalancer member create <ID_ПУЛА> \
        --name <ИМЯ_УЧАСТНИКА> \
        --address <IP-АДРЕС_ВМ> \
        --subnet-id <ID_ПОДСЕТИ> \
        --protocol-port <НОМЕР_ПОРТА_НАЗНАЧЕНИЯ>
      ```

      {/tab}
      
      {tab(Windows (PowerShell))}
      
      ```console
      openstack loadbalancer member create <ID_ПУЛА> `
        --name <ИМЯ_УЧАСТНИКА> `
        --address <IP-АДРЕС_ВМ> `
        --subnet-id <ID_ПОДСЕТИ> `
        --protocol-port <НОМЕР_ПОРТА_НАЗНАЧЕНИЯ>
      ```

      {/tab}

      {/tabs}

      {note:warn}

      Все member-объекты в рамках одного пула должны использовать один и тот же порт.

      {/note}

   1. Создайте для пула healthcheck-объект. Он будет проверять состояние и доступность участников (members) пула.

      {tabs}
      
      {tab(Linux/macOS (bash, zsh))}
            
      ```console
      openstack loadbalancer healthmonitor create <ID_ПУЛА> \
        --name <ИМЯ_HEALTHCHECK-ОБЪЕКТА> \
        --delay <ЗАДЕРЖКА_В_СЕКУНДАХ> \
        --timeout <ТАЙМ-АУТ_В_СЕКУНДАХ> \
        --max-retries <КОЛИЧЕСТВО_УСПЕШНЫХ_ПОПЫТОК> \
        --max-retries-down <КОЛИЧЕСТВО_НЕУСПЕШНЫХ_ПОПЫТОК> \
        --type <ТИП_ПРОВЕРКИ>
      ```

      {/tab}
      
      {tab(Windows (PowerShell))}
      
      ```console
      openstack loadbalancer healthmonitor create <ID_ПУЛА> `
        --name <ИМЯ_HEALTHCHECK-ОБЪЕКТА> `
        --delay <ЗАДЕРЖКА_В_СЕКУНДАХ> `
        --timeout <ТАЙМ-АУТ_В_СЕКУНДАХ> `
        --max-retries <КОЛИЧЕСТВО_УСПЕШНЫХ_ПОПЫТОК>`
        --max-retries-down <КОЛИЧЕСТВО_НЕУСПЕШНЫХ_ПОПЫТОК> `
        --type <ТИП_ПРОВЕРКИ>
      ```

      {/tab}

      {/tabs}

   1. Создайте прослушиватель, который будет обрабатывать входящие соединения:

      {tabs}
      
      {tab(Linux/macOS (bash, zsh))}

         ```console
         openstack loadbalancer listener create <ID_БАЛАНСИРОВЩИКА> \
           --name <ИМЯ_ПРОСЛУШИВАТЕЛЯ> \
           --protocol <ПРОТОКОЛ> \
           --default-pool <ID_ПУЛА> \
           --protocol-port <НОМЕР_ПОРТА> \
           --timeout-member-data <ТАЙМ-АУТ_1> \
           --timeout-member-connect <ТАЙМ-АУТ_2> \
           --timeout-client-data <ТАЙМ-АУТ_3> \
           --timeout-tcp-inspect <ТАЙМ-АУТ_4>
         ```
      
         Здесь:
      
         - `<ID_БАЛАНСИРОВЩИКА>` — идентификатор балансировщика нагрузки.
         - `<ИМЯ_ПРОСЛУШИВАТЕЛЯ>` — название прослушивателя.
         - `<ПРОТОКОЛ>` — протокол балансировки. Возможные значения: `TCP`, `HTTP`, `HTTPS`.
         - `<ID_ПУЛА>` — идентификатор пула.
         - `<НОМЕР_ПОРТА>` — порт протокола балансировки.
         - `<ТАЙМ-АУТ_1>` — тайм-аут бездействия сервера. По умолчанию — `50000`.
         - `<ТАЙМ-АУТ_2>` — тайм-аут установки соединения балансировщика с сервером. По умолчанию — `5000`.
         - `<ТАЙМ-АУТ_3>` — тайм-аут бездействия клиента. По умолчанию — `50000`.
         - `<ТАЙМ-АУТ_4>` — ожидание дополнительных TCP-пакетов для проверки содержимого. По умолчанию — `0`.

      {/tab}

      {tab(Windows (PowerShell))}

         ```console
         openstack loadbalancer listener create <ID_БАЛАНСИРОВЩИКА> `
           --name <ИМЯ_ПРОСЛУШИВАТЕЛЯ> `
           --protocol <ПРОТОКОЛ> `
           --default-pool <ID_ПУЛА> `
           --protocol-port <НОМЕР_ПОРТА> `
           --timeout-member-data <ТАЙМ-АУТ_1> `
           --timeout-member-connect <ТАЙМ-АУТ_2> `
           --timeout-client-data <ТАЙМ-АУТ_3> `
           --timeout-tcp-inspect <ТАЙМ-АУТ_4>
         ```

         Здесь:

         - `<ID_БАЛАНСИРОВЩИКА>` — идентификатор балансировщика нагрузки.
         - `<ИМЯ_ПРОСЛУШИВАТЕЛЯ>` — название прослушивателя.
         - `<ПРОТОКОЛ>` — протокол балансировки. Возможные значения: `TCP`, `HTTP`, `HTTPS`.
         - `<ID_ПУЛА>` — идентификатор пула.
         - `<НОМЕР_ПОРТА>` — порт протокола балансировки.
         - `<ТАЙМ-АУТ_1>` — тайм-аут бездействия сервера. По умолчанию — `50000`.
         - `<ТАЙМ-АУТ_2>` — тайм-аут установки соединения балансировщика с сервером. По умолчанию — `5000`.
         - `<ТАЙМ-АУТ_3>` — тайм-аут бездействия клиента. По умолчанию — `50000`.
         - `<ТАЙМ-АУТ_4>` — ожидание дополнительных TCP-пакетов для проверки содержимого. По умолчанию — `0`.

      {/tab}

      {/tabs}

1. Чтобы применить (`set`) нужные настройки к объектам, которые входят в правило балансировки, или отменить настройки (`unset`), используйте соответствующие команды (например, `openstack loadbalancer pool set`).

1. Чтобы удалить правило балансировки:

   1. Найдите идентификатор нужного прослушивателя.

   1. Определите идентификатор пула, используемого этим прослушивателем:

      1. Выполните команду:

         ```console
         openstack loadbalancer listener show <ID_ПРОСЛУШИВАТЕЛЯ>
         ```

      1. Идентификатор пула будет содержаться в поле `default_pool_id`.

   1. Удалите прослушиватель:

      ```console
      openstack loadbalancer listener delete <ID_ПРОСЛУШИВАТЕЛЯ>
      ```

   1. Удалите пул:

      ```console
      openstack loadbalancer pool delete <ID_ПУЛА>
      ```

{/tab}

{/tabs}

## Удаление балансировщика нагрузки

{tabs}

{tab(Личный кабинет)}

Это групповая операция: при необходимости можно удалить сразу несколько балансировщиков нагрузки, выбрав их с помощью флажков.

Для удаления балансировщика:

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где находится нужный балансировщик.
1. Перейдите в раздел **Виртуальные сети** → **Балансировщики нагрузки**.
1. Выполните одно из действий для нужного балансировщика:

   - Выберите с помощью флажка балансировщик, затем нажмите кнопку **Удалить**.
   - Нажмите ![ ](/ru/assets/more-icon.svg "inline") для балансировщика и выберите пункт **Удалить балансировщик**.

1. Подтвердите удаление балансировщика.

{/tab}

{tab(OpenStack CLI)}

1. Убедитесь, что:

   1. OpenStack CLI [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack) вместе с [дополнительным пакетом](/ru/tools-for-using-services/cli/openstack-cli#2_opcionalno_ustanovite_dopolnitelnye_pakety) `python-octaviaclient`.
   1. Вы можете [авторизоваться](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в OpenStack CLI.

1. [Получите идентификатор](#prosmotr_spiska_balansirovshchikov_nagruzki_i_informacii_o_nih) балансировщика нагрузки.

1. Удалите балансировщик:

   ```console
   openstack loadbalancer delete <ID_БАЛАНСИРОВЩИКА>
   ```

{/tab}

{/tabs}

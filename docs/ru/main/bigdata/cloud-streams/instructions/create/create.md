Создание кластера Cloud Streams включает в себя следующие шаги:

1. Выбор версии дистрибутива Cloud Streams.
2. Настройка кластера и выбор устанавливаемых компонентов дистрибутива Cloud Streams.
3. Настройка нод кластера.
4. Выбор компонентов, устанавливаемых на ноды кластера.
5. Настройка доступа к выбранным компонентам кластера Cloud Streams.

## Начало создания кластера Cloud Streams

Для создания кластера Cloud Streams перейдите в раздел «Большие данные» → «Кластеры». На карточке «Создание кластера Cloud Streams» нажмите «Создать кластер».

В новом окне откроется конфигуратор кластера, состоящий из нескольких этапов, в результате определяющий параметры создаваемого кластера.

На всех этапах конфигуратор информирует о стоимости создаваемого кластера, дополнительных возможностях, а также позволяет обратиться в поддержку в случае возникновения вопросов.

На первом этапе создания необходимо выбрать желаемую конфигурацию кластера. Преднастроенные типы сред отличаются параметрами масштабирования и активированными расширениями:

- Cloud Streams Community/Enterprise
- Cloud Streams Community Test/Enterprise Test

Версии Community Test/Enterprise Test предлагают продвинутую настройку компонентов для создания dev-сред и подходят для тестирования. Данную опцию рекомендуется выбирать только продвинутым пользователям.

Подробнее о различиях между Community и Enterprise версиями можно узнать из статьи [Лицензии Cloud Streams](../../concepts/types/).

После выбора нажмите «Следующий шаг» для перехода к настройке сетевой конфигурации кластера и выбора устанавливаемых компонентов дистрибутива Cloud Streams.

## Настройка сетевой конфигурации и выбор компонентов

На этом этапе создания необходимо указать некоторые параметры кластера. Мастер создания отражает следующие поля конфигурации:

| Параметр | Описание |
| --- | --- |
| Имя кластера | Отображаемое имя кластера. Также задает hostname в ОС. |
| Зона доступности	| Выбор датацентра, где будет запущен инстанс. |
| Сеть | Создание кластера в существующей сети или создать новую. При создании новой сети убедитесь что в настройках сети включен параметр «Доступ для выхода в интернет». |
| Настройка кластера | Выбор компонентов Cloud Streams для установки на кластер. Доступен выбор из преднастроенных шаблонов, либо выбор компонентов вручную. Рекомендуется выбрать один из преднастроенных шаблонов настройки кластера, подходящий для вашей работы. Во время дальнейшей настройки будет предоставлена возможность поменять список компонентов более гибко.|

<warn>

Для некоторых шаблонов необходимо наличие доступа к специальному флейвору виртуальных машин. Для получения доступа обратитесь в [службу поддержки](https://mcs.mail.ru/help/contact-us).

</warn>

После выбора нажмите «Следующий шаг» для перехода к настройке виртуального аппаратного обеспечения нод кластера.

## Настройка виртуального аппаратного обеспечения кластера

На этом этапе создания необходимо указать некоторые параметры нод кластера. Мастер создания отражает следующие поля конфигурации, настраиваемые отдельно для Master и Worker узлов:

| Поле           | Описание |
|--------------------------------------|----------------------------------------|
| Тип инстанса        | Конфигурация узла — количество CPU и оперативной памяти. |
| Количество узлов  | Количество машин. Указывается отдельно для узлов Master и Worker. |
| Количество дисков на один узел | Количество дисков на узле. Задаётся отдельно для каждого узла. Максимальное значение — 8. |
| Размер диска | Объем диска на узлах. Предельные значения — от 500 до 2000 Гб. |
| Тип диска  | Тип дисков (SSD/High-IOPS SSD). |

Следующие параметры настраиваются для всего кластера в целом:

| Поле           | Описание |
|--------------------------------------|----------------------------------------|
| Подключить monitoring-узел | Подключить Arenadata Monitoring bundle для наблюдения за кластером с помощью сервисов Carbon, Graphana, Graphite и Diamond. Подробнее о функциональности можно узнать на [сайте Arenadata](https://docs.arenadata.io/mon/ru/index.html). |
| Подключить edge-узел | Подключить узел для возможности подключения к кластеру для более точной настройки через UI установленных компонентов. |
| Ключевая пара | Выбор ключевой пары для доступа к edge-узлу. |
| Автомасштабирование дисков | Включение функции автоматического расширения дискового пространства на узлах кластера. |

Далее нажмите «Следующий шаг» для перехода к выбору компонентов, устанавливаемых на ноды кластера.

## Выбор компонентов для нод кластера Cloud Streams

На этом этапе создания предоставляется опция гибкой настройки компонентов, которые будут установлены на кластер.

Если на предыдущих шагах вы выбрали шаблон с предустановленным списком компонентов, здесь можно увидеть детали о том, какие именно модули будут установлены.

Также существует возможность вручную выбрать компоненты, устанавливаемые на узлы. Для этого выберите «Продвинутая» среди вариантов установки компонентов, а затем перетащите необходимые компоненты из списка справа на узлы вашей конфигурации Cloud Streams.

После выбора нажмите «Следующий шаг» для перехода к настройке доступа к кластеру.

## Настройка доступа к компонентам кластера Cloud Streams

На этом этапе создания задаются параметры учетной записи, которые будут использоваться для получения доступа к Monitoring-узлу кластера.

Заполнив все настройки, нажмите «Создать кластер» для создания кластера. Кластер будет создан в течение 10–15 минут. В данный период разворачивается операционная система на дисках инстансов, а также работают системные инструменты, обеспечивающие настройку кластера в соответствии с указанными параметрами.

Виртуальную машину можно подключить к сети с помощью порта. Порт — виртуальная сетевая карта ВМ, для которой настраиваются сущности:

- группы безопасности;
- подключенная сеть;
- DNS-имя.

Подробнее про сети и порты в разделах [Управление сетями и подсетями](/ru/networks/vnet/operations/manage-net) и [Управление портами](/ru/networks/vnet/operations/manage-ports).

## Подключение сети к ВМ

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>OpenStack CLI</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
2. Перейдите в раздел **Облачные вычисления → Виртуальные машины**.
3. Выберите нужную ВМ и перейдите на вкладку **Сети**.
4. Нажмите кнопку **Добавить подключение**.
5. В появившемся окне:

   1. **Имя**: задайте имя сети.
   2. **Сеть для подключения**: выберите значение из списка:

      - **Создать новую сеть**: подробнее о создании новой сети в разделе [Управление сетями и подсетями](/ru/networks/vnet/operations/manage-net).
      - **Внешняя сеть (ext-net)**: виртуальной машине будет автоматически назначен IP-адрес.
      - Существующая сеть.

      При выборе уже существующей сети задайте следующие параметры:

      - **Назначить внешний IP**: включите, если нужен доступ к ВМ через интернет.
      - **DNS-имя**: имя, по которому можно обратиться к ВМ через [приватный DNS](/ru/networks/dns/private-dns).
      - **Задать IP-адрес**: включите, чтобы задать конкретный IP-адрес из пула адресов подсети.

   3. **Настройки Firewall**: укажите нужные группы безопасности. Подробнее в разделе [Управление правилами файервола](/ru/networks/vnet/operations/secgroups).

7. Нажмите кнопку **Сохранить**.

</tabpanel>
<tabpanel>

Убедитесь, что клиент OpenStack [установлен](/ru/manage/tools-for-using-services/openstack-cli#1_ustanovite_klient_openstack), и [пройдите аутентификацию](/ru/manage/tools-for-using-services/openstack-cli#3_proydite_autentifikaciyu) в проекте.

### Подключение к существующему порту

1. Получите ID виртуальной машины, которую планируется подключить к сети:

   ```bash
   openstack server list
   ```

1. Получите список сетей и входящих в них подсетей:

   ```bash
   openstack network list
   ```

1. Получите список доступных портов в нужной сети:

   ```bash
   openstack port list --network <имя или идентификатор сети>
   ```

1. Присоедините выбранный порт к ВМ:

   ```bash
   openstack server add port <ID виртуальной машины> <ID порта>
   ```

1. Убедитесь, что порт успешно подключен к ВМ:

   ```bash
   openstack port list --server <ID виртуальной машины>
   ```

### Создание нового порта

1. Получите список сетей и входящих в них подсетей:

   ```bash
   openstack network list
   ```

1. Получите список IP-адресов для подсети, к которой планируется выполнить подключение:

   ```bash
   openstack subnet list --network <имя или идентификатор сети>
   ```

1. Получите список групп безопасности:

   ```bash
   openstack security group list
   ```

1. Создайте порт одним из способов:

   - В нужной сети и с группой безопасности `default`:

      ```bash
      openstack port create <имя порта> --network <имя или идентификатор сети>
      ```

   - С указанием параметров:

      ```bash
      openstack port create <имя порта> \
                            --network <имя или идентификатор сети> \
                            --fixed-ip subnet=<имя или идентификатор подсети>,ip-address=<IP-адрес порта> \
                            --security-group <ID группы безопасности>
      ```

      Чтобы посмотреть полный перечень поддерживаемых параметров, выполните команду:

      ```bash
      openstack port create --help
      ```

      Также возможно создать порт с [опциями DHCP](https://github.com/Juniper/contrail-controller/wiki/Extra-DHCP-Options).

      При необходимости [установите порту плавающий IP-адрес](/ru/networks/vnet/operations/manage-floating-ip).

   В результате будет выведен ID созданного порта и другая информация о нем.

1. Получите ID виртуальной машины, которую планируется подключить к сети:

   ```bash
   openstack server list
   ```

1. Присоедините созданный порт к ВМ:

   ```bash
   openstack server add port <ID виртуальной машины> <ID порта>
   ```

1. Убедитесь, что порт успешно подключен к ВМ:

   ```bash
   openstack port list --server <ID виртуальной машины>
   ```

</tabpanel>
</tabs>

## Удаление сети ВМ

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>OpenStack CLI</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
2. Перейдите в раздел **Облачные вычисления → Виртуальные машины**.
3. Выберите нужную ВМ и перейдите на вкладку **Сети**.
4. Выполните одно из действий для нужной сети:

   - Выберите с помощью флажка сеть, затем нажмите кнопку **Удалить**.
   - Раскройте меню подключенной сети и выберите пункт **Удалить подключение**.

5. В появившемся окне нажмите кнопку **Подтвердить**.

Подключение сети к ВМ будет удалено, но созданный ранее порт останется в статусе **Не подключен**. Подробнее об удалении портов в разделе [Управление портами](/ru/networks/vnet/operations/manage-ports).

</tabpanel>
<tabpanel>

1. Убедитесь, что клиент OpenStack [установлен](/ru/manage/tools-for-using-services/openstack-cli#1_ustanovite_klient_openstack), и [пройдите аутентификацию](/ru/manage/tools-for-using-services/openstack-cli#3_proydite_autentifikaciyu) в проекте.
2. Получите ID виртуальной машины:

   ```bash
   openstack server list
   ```

3. Получите список портов у ВМ:

   ```bash
   openstack port list --server <ID виртуальной машины>
   ```

4. Удалите ненужный порт:

   ```bash
   openstack port delete <имя или идентификатор порта>
   ```

</tabpanel>
</tabs>

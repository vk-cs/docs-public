## Общий вид подписанного URL

```
https://hb.vkcs.cloud/<имя_бакета>/<имя_ключа>?
     X-Amz-Algorithm=AWS4-HMAC-SHA256
    &X-Amz-Expires=<интервал времени в секундах>
    &X-Amz-SignedHeaders=<список заголовков разделенный символами ";">
    &X-Amz-Date=<время в формате ISO 8601>
    &X-Amz-Credential=<access-key-id>/<YYYYMMDD>/ru-msk/s3/aws4_request
    &X-Amz-Signature=<подпись>
```

Где:

- **X-Amz-Algorithm** — Указание версии подписи и алгоритм ее вычисления. Значение - AWS4-HMAC-SHA256.
- **X-Amz-Expires** — Срок действия ссылки в секундах. Максимальное значение — 604800 секунд (7 дней).
- **X-Amz-SignedHeaders** — Заголовки запроса, которые необходимо подписать. Обязательно подписывать заголовок host и все заголовки x-amz-\*, которые используются в запросе.
- **X-Amz-Signature** — Подпись запроса.
- **X-Amz-Date** — Время в формате ISO8601, например 20180719T000000Z. Дата должна по значению совпадать с датой в параметре X-Amz-Credential.
- **X-Amz-Credential** — Идентификатор для подписи формата `<access-key-id>`/`<YYYYMMDD>`/`ru-msk`/`s3`/`aws4_request`, где `<YYYYMMDD>` должна совпадать с датой, установленной в заголовке X-Amz-Date.

## Составление подписанного URL

<info>

Программно сгенерировать заранее подписанный URL-адрес можно с помощью REST API, интерфейса командной строки AWS и AWS SDK для Java, .NET, Ruby, PHP, Node.js и Python.

</info>

В SDK AWS по умолчанию используется подпись версии 4 для аутентификации запросов. При использовании пакетов SDK AWS с подписью версии 3, может потребоваться запросить у сервиса версию подписи 4.

Для получения предварительно подписанного URL следует:

1.  Вычислить подпись: составить строку и вычислить подпись с помощью алгоритма подписи строк.
2.  Составить подписанный URL для своего запроса.

<info>

Для составления подписанного URL необходимо владеть статическими ключами доступа.

</info>

## Примеры получения подписанной ссылки

С помощью S3 CLI можно сгенерировать предварительно подписанную ссылку следующей командой:

```bash
aws s3 presign s3://<имя_бакета>/<название_ключа> --endpoint-url https://hb.vkcs.cloud --expires-in <время_в_секундах>
```

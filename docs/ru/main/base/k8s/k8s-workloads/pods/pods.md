## Описание

Под является минимальной вычислительной единицей в терминологии Kubernetes.

Под — группа из одного или нескольких контейнеров приложений, включающая общие используемые хранилище (тома), IP-адрес и информацию по их запуску.

## Использование подов

В Kubernetes есть два основных пути использования подов:

- Под запускающий единственный контейнер. Модель "один-контейнер-на-один-под" является более распространенной в Kubernetes и в данном кейсе можно считать, что под является обёрткой для контейнера. Нужно помнить, что Kubernetes управляет именно подами, а не контейнерами напрямую.
- Под запускающий несколько контейнеров внутри себя. Под может содержать в себе приложение состоящее из нескольких контейнеров, взаимодействие которых тесно связано и есть необходимость разделять ресурсы. Например контейнер-1, являющийся веб-сервером, отдаёт данные с общего диска "во вне", и есть контейнер-2, который обновляет и изменяет эти данные на диске.

Второй способ, с группировкой нескольких контейнеров внутри одного пода, является довольно специфичным случаем. Не рекомендуется его использовать без явной необходимости.

## Работа с подами

Каждый под представляет из себя одиночный инстанс (экземпляр) запущенного приложения. Если возникает необходимость в горизонтальном масштабировании, чтобы предоставить больше ресурсов за счет запуска большего количества инстансов, следует запускать множество подов, по одному на каждый инстанс приложения.

В Kubernetes это обычно называется репликацией. Реплицированные поды обычно создаются и управляются объектами Kubernetes, вроде Deployment или Job.

Редко когда возникает необходимость создавать отдельные поды непосредственно в Kubernetes. Это связано с тем, что поды разработаны как относительно эфемерные и одноразовые объекты.

Лучшими практиками при работе с подами является проставление requests и limits для контейнеров в поде. Больше информации о лимитах в [статье](limits-and-requests).

<info>

В кластерах Kubernetes от VK Cloud для запускаемых контейнеров без указанных requests и limits применяются следующие значения по умолчанию:

- Requests: 100m / 64Mb
- Limits: 500m / 512Mb

</info>

Редко когда возникает необходимость создавать отдельные поды непосредственно в Kubernetes. Это связано с тем, что поды разработаны как относительно эфемерные и одноразовые объекты.

В примере ниже создаются два отдельных пода и проверяется их сетевая связность.

Пример манифеста для пода с веб-сервером Nginx:

```
---
apiVersion: v1
kind: Pod
metadata:
  name: nginx-pod
spec:
  containers:
  - image: nginx:1.12
    name: nginx
    ports:
    - containerPort: 80
```

Нужно сохранить манифест из примера в файл pod.yaml и создать из него под командой:

```
kubectl apply -f pod.yaml
```

После чего можно проверить создался ли под (ключ _-o_ выводит более подробную информацию). В столбце IP, найдите IP-адрес пода, который нам понадобится позже:

```
kubectl get pod -o wide
NAME        READY   STATUS    RESTARTS   AGE   IP             NODE        NOMINATED NODE   READINESS GATES
nginx-pod   1/1     Running   0          42m   10.100.6.201   test-node   <none>           <none>
```

Теперь создайте ещё один под, с которого проверяется работоспособность первого. Запустите под как интерактивную оболочку :

```
kubectl run -it --rm --image=centos centos-pod -- /bin/bash
```

Попав в оболочку пода centos-pod, выполните с помощью curl запрос к веб-сервису `nginx`. Запрос нужно отправить на адрес пода, который вы получили ранее.

```
curl 10.100.6.201
```

```
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```

В ответ отобразится приветственная страница nginx по умолчанию, что говорит о том, что поды работают.

С более подробной информацией о подах можно ознакомиться на [официальном сайте](https://kubernetes.io/docs/concepts/workloads/pods/) Kubernetes.

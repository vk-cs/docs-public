Чтобы разграничить доступ к данным, вы можете добавить пользователей для инстанса БД и назначить им доступ к тем или иным базам данных, созданным на инстансе. Для всех типов СУБД, кроме Redis, первый пользователь для инстанса БД создается при [добавлении инстанса](../create).

Помимо обычных пользователей, у каждого инстанса БД есть администратор — пользователь, который имеет максимально широкие полномочия в рамках инстанса. Единственная доступная операция по управлению администратором — [сброс пароля](#sbros_parolya_administratora).

<warn>

На инстансах Redis 5 недоступны никакие операции по управлению пользователями, кроме сброса пароля администратора.

</warn>

## Сброс пароля администратора

Используйте эту опцию, чтобы изменить текущий пароль [администратора](../../connect) без ввода старого пароля.

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Раскройте меню нужного инстанса БД и выберите пункт **Сбросить пароль администратора БД**.
1. Прочитайте предупреждение и нажмите кнопку **Сбросить**.
1. Скопируйте и сохраните имя пользователя и новый пароль, сгенерированный платформой.
1. Нажмите кнопку **Готово**.

## Просмотр списка пользователей

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Нажмите на имя нужного инстанса БД.
1. На странице инстанса перейдите перейдите на вкладку **Пользователи**.

Отобразится список пользователей и доступных им БД.

</tabpanel>
</tabs>

<info>

Администратор в списке пользователей не отображается.

</info>

## Добавление пользователя

При добавлении пользователю назначаются доступные ему БД. В этих БД пользователь будет иметь полный набор разрешений. Если вы не хотите давать пользователю такие полномочия, [настройте разрешения](#nastroyka_razresheniy_dlya_polzovatelya) отдельно, подключившись к базе данных с правами администратора.

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Нажмите на имя нужного инстанса БД.
1. На странице инстанса перейдите на вкладку **Пользователи**.
1. Нажмите кнопку **Добавить**.
1. Задайте имя пользователя.

   Требования к имени:

     - Может содержать только цифры, заглавные, строчные латинские буквы и символ нижнего подчеркивания.
     - Не может быть длиннее 16 символов.
     - Не может начинаться с `mcs_`.
     - Не может быть из списка запрещенных имен:

        | Тип СУБД | Запрещенные имена пользователя |
        |--|--|
        | PostgreSQL<br>PostgresPro | `os_admin`, `root`, `postgres`, `replicator` |
        | MySQL | `clusterrepuser` (запрещено только для кластерной конфигурации), `os_admin`, `root` |
        | ClickHouse | `os_admin`, `root`, `default`, `replicator` |
        | MongoDB | `os_admin`, `root` |
        | Tarantool | `os_admin`, `root`, `admin`, `guest`, `replicator` |
        | OpenSearch | `os_admin`, `root`, `dbaasadmin` |
        | Redis 6 | `os_admin`, `root` |

1. Придумайте или сгенерируйте пароль.

    Требования к паролю:

     - может содержать только цифры, символы из диапазона `.,!$&*()-+=`, заглавные и строчные латинские буквы;
     - должен состоять как минимум из 16 символов;
     - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

    Если пароль будет утерян, его можно [изменить](#izmenenie_parolya_polzovatelya). Восстановить пароль нельзя.

1. Выберите из списка базы данных, которые будут доступны пользователю.
1. Нажмите кнопку **Создать пользователя**.

</tabpanel>
</tabs>

## Изменение списка доступных БД

Для пользователя можно изменить список доступных ему баз данных инстанса.

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Нажмите на имя нужного инстанса БД.
1. На странице инстанса перейдите на вкладку **Пользователи**.
1. Раскройте меню нужного пользователя и выберите пункт **Редактировать пользователя**.
1. Отредактируйте список доступных БД.
1. Нажмите **Сохранить**.

После назначения новой БД пользователю доступны в ней полные разрешения.

</tabpanel>
</tabs>

## Изменение пароля пользователя

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Раскройте меню инстанса.

    Дальнейшие действия зависят от того, есть ли в меню опция **Изменить пароль**. Для некоторых типов СУБД и конфигураций пароль пользователя можно изменить только на странице самого инстанса.

    <tabs>
    <tablist>
    <tab>Опция есть в меню</tab>
    <tab>Опции нет в меню</tab>
    </tablist>
    <tabpanel>

      1. Выберите опцию **Изменить пароль**.
      1. В открывшемся окне выберите пользователя из списка.
      1. Задайте или сгенерируйте новый пароль.

         Требования к паролю:

         - может содержать только цифры, символы из диапазона `.,!$&*()-+=`, заглавные и строчные латинские буквы;
         - должен состоять как минимум из 16 символов;
         - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

      1. Нажмите кнопку **Изменить пароль**.

    </tabpanel>
    <tabpanel>

      1. Нажмите на имя нужного инстанса БД.
      1. На странице инстанса перейдите на вкладку **Пользователи**.
      1. Раскройте меню нужного пользователя и выберите пункт **Изменить пароль**.
      1. Задайте или сгенерируйте новый пароль.

         Требования к паролю:

         - может содержать только цифры, символы из диапазона `.,!$&*()-+=`, заглавные и строчные латинские буквы;
         - должен состоять как минимум из 16 символов;
         - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

      1. Нажмите кнопку **Задать пароль**.

    </tabppanel>
    </tabs>

</tabpanel>
</tabs>

## Удаление пользователя

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

Это групповая операция: при необходимости можно удалить сразу несколько пользователей, выбрав их с помощью флажков.

1. Перейдите в [личный кабинет](https://mcs.mail.ru/app/) VK Cloud.
1. Выберите проект, где находится нужный инстанс БД.
1. Перейдите в раздел **Базы данных** → **Инстансы баз данных**.
1. Нажмите на имя нужного инстанса БД.
1. На странице инстанса перейдите на вкладку **Пользователи**.
1. Раскройте меню нужного пользователя и выберите пункт **Удалить пользователя**.
1. Подтвердите удаление.

</tabpanel>
</tabs>

## Настройка разрешений для пользователя

Средствами VK Cloud нельзя настроить избирательные разрешения внутри БД — например, доступ только на чтение или доступ к ограниченному набору данных. Настроить такие разрешения можно только непосредственно в БД, подключившись к ней напрямую с правами администратора.

1. Подключитесь к базе данных предпочитаемым способом, например, [при помощи SDK](../../connect) или внешнего средства администрирования.

   Если у инстанса БД есть хост с ролью `Master`, подключитесь к нему. Если у инстанса нет выделенных хостов с ролью `Master` (как, например, у ClickHouse), подключитесь к любому хосту инстанса.

   Чтобы подключиться с правами администратора укажите:

   - [Имя пользователя](../../connect) для нужного типа СУБД.
   - Пароль администратора. Если вы не знаете пароль, или если это первое подключение к инстансу БД после его создания, перед подключением [сбросьте пароль](#sbros_parolya_administratora).

   <info>

   На инстансах OpenSearch все пользователи, созданные через VK Cloud, получают права администратора, для настройки разрешений вы можете подключиться от имени любого из них.

   </info>

2. Настройте для пользователя необходимые разрешения.

Список назначенных пользователю БД отображается в личном кабинете, на вкладке **Пользователи** инстанса БД, но доступные разрешения в нем не отображаются.

- БД остается назначенной пользователю, если часть разрешений была отозвана.

- БД назначается пользователю, если в ней были настроены любые разрешения для этого пользователя.

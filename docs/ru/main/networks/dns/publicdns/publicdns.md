## Настройка ролевой модели

Для работы с публичным DNS настройте [роли](/ru/base/account/concepts/rolesandpermissions) для пользователей [личного кабинета](https://mcs.mail.ru/app) VK Cloud:

- Роль для просмотра DNS-зон и ресурсных записей:

  - Наблюдатель.

- Роли для редактирования DNS-зон и ресурсных записей:

  - Владелец проекта.
  - Администратор сети.
  - Суперадминистратор.

## Квоты и лимиты

- Максимальное количество DNS-зон внутри проекта — 100.
- Максимальное количество ресурсных записей каждого типа для одной DNS-зоны — 500.

## Просмотр списка DNS-зон

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.

</tabpanel>
<tabpanel>

Воспользуйтесь методом `GET /v2/dns/` из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

## Создание зоны

DNS-зона — логическое объединение доменных имен ваших ресурсов, содержащее их ресурсные записи.

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Нажмите кнопку **Добавить зону**.
1. Задайте параметры DNS-зоны:

   - **DNS-зона**: имя создаваемой зоны, например, домен, который был ранее приобретен.

     <info>

     Имя DNS-зоны должно содержать минимум одну точку, не должно оканчиваться точкой или цифрами.

     </info>

   - **Контактный email**: почта администратора зоны.
   - **Time to expire**: время (в секундах), после которого вторичный NS-сервер перестает отвечать на запросы для этой зоны, если первичный NS-сервер не отвечает. Значение должно быть больше, чем сумма в полях **Time to refresh** и **Time to retry**.
   - **Time to refresh**: время (в секундах), по истечении которого вторичный NS-сервер должен запросить SOA-запись у первичного, чтобы поддержать изменения в зоне.
   - **Time to retry**: время (в секундах), по истечении которого вторичный NS-сервер вновь запросит SOA-запись у первичного, если первичный NS-сервер не ответил. Значение должно быть меньше указанного в **Time to refresh**.
   - **Time to live (TTL)**: время жизни кеша при отрицательном ответе на запрос в зоне.

1. Нажмите кнопку **Добавить зону**.
1. Обратитесь к владельцу [указанного](https://mcs.mail.ru/app/services/dns/list) домена, чтобы делегировать управление зоной на DNS-сервера VK Cloud.

</tabpanel>
<tabpanel>

Воспользуйтесь методом `POST /v2/dns/` из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

<info>

У большинства провайдеров возможно самостоятельно делегировать управление зоной. Если у вас возникли вопросы, как это сделать, обратитесь за помощью к владельцу [указанного](https://mcs.mail.ru/app/services/dns/list) домена.

</info>

## Редактирование зоны

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Раскройте меню нужной зоны и выберите пункт **Редактировать**.
1. Внесите изменения и нажмите кнопку **Сохранить изменения**.

</tabpanel>
<tabpanel>

Воспользуйтесь методом `PUT /v2/dns/<dns-uuid>` из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

## Создание подзоны

Подзона — это зона DNS, которая находится уровнем ниже текущей. Например, для домена `example.com` подзоной будет `subzone.example.com`.

Подзона может быть создана:

- В том же проекте, где размещается основная зона. Этот подход применяется для отделения ресурсных записей подзоны от записей основной зоны.
- У стороннего DNS-провайдера.

<warn>

Создать подзону для зоны в другом проекте нельзя.

</warn>

Чтобы создать подзону в проекте VK Cloud, [создайте](#dobavlenie_resursnyh_zapisey) две ресурсные NS-записи с именем подзоны, повторно делегирующие подзону на DNS-сервера VK Cloud.

<info>

Если вы хотите создать подзону у стороннего провайдера, то созданные NS-записи должны будут указывать на DNS-сервера стороннего провайдера.

</info>

После создания NS-записей вы можете создать зону для делегированного поддомена.

## Удаление зоны

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

Это групповая операция: при необходимости можно удалить сразу несколько зон, выбрав их с помощью флажков.

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Раскройте меню нужной зоны и выберите пункт **Удалить**.
1. Подтвердите действие.

</tabpanel>
<tabpanel>

Воспользуйтесь методом `DELETE /v2/dns/<dns-uuid>` из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

## Добавление ресурсных записей

Ресурсная запись — DNS-запись домена в системе доменных имен. С их помощью вы определяете, куда направлять запросы, которые поступают на доменные имена, а также предоставляете дополнительную информацию о домене.

VK Cloud поддерживает типы ресурсных записей:

- `A` — запись DNS, которая сопоставляет доменное имя с адресом IPv4.
- `AAAA` — запись DNS, которая сопоставляет доменное имя с адресом IPv6.
- `NS` — запись DNS, которая содержит адрес обслуживающего данную зону или подзону сервера имен. По умолчанию в зоне будут установлены две записи `NS`. Эти записи устанавливаются на стороне владельца доменных имен, чтобы передать права управления доменом серверу имен VK Cloud.
- `CNAME` — запись DNS, привязывающая псевдоним к доменному имени. Обычно используется для привязки поддомена (например, `www`) к домену, в котором размещен контент этого поддомена.
- `MX` — запись DNS, сообщающая адрес сервера, обрабатывающего электронную почту.
- `SRV` — запись DNS, определяющая имя хоста и порт сервера для некоторых сетевых служб.
- `TXT` — запись DNS, которая содержит текстовую информацию для источников за пределами домена.

Чтобы добавить ресурсную запись:

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Нажмите на имя зоны, для которой требуется добавить ресурсную запись.
1. Нажмите кнопку **Добавить запись**.
1. Заполните поля в зависимости от значения **Тип записи**:

   <details>
    <summary>CNAME</summary>

   - **Имя** (добавляемый псевдоним):

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`;
     - `\*.dns.zone` — указывает на любое имя в запросе к домену.

   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **Значение**: FQDN-адрес назначения (то, куда указывает добавляемый псевдоним). Максимальная длина — 255 символов. Должно состоять из двух или более поддоменов. Максимальная длина поддомена — 63 символа. Допустимы только цифры, латинские буквы, символы `.` и `-`.

   Пример: необходимо создать CNAME-запись `www.example.com`, указывающую на `example.com`. Для этого в поле **Имя** укажите `www`, а в поле **Значение** — `example.com`.

   </details>
   <details>
    <summary>A</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`;
     - `\*.dns.zone` — указывает на любое имя в запросе к домену.

   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **IP-адрес**: IP-адрес (IPv4). Выберите из списка существующих ВМ или укажите новый.

   </details>
   <details>
    <summary>MX</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`.

   - **Приоритет**: приоритет хоста. Чем ниже значение, тем более предпочтительный хост.
   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **Значение**: FQDN-адрес почтового сервера. Максимальная длина — 255 символов. Должно состоять из двух или более поддоменов. Максимальная длина поддомена — 63 символа. Допустимы только цифры, латинские буквы, символы `.` и `-`.

   </details>
   <details>
    <summary>AAAA</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`;
     - `\*.dns.zone` — указывает на любое имя в запросе к домену.

   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **IP-адрес**: IP-адрес (IPv6).

   </details>
   <details>
    <summary>SRV</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`;
     - `\*.dns.zone` — указывает на любое имя в запросе к домену.

   - **Сервис**: символьное имя сервиса (например, `_sip`).
   - **Протокол**: символьное имя протокола (например, `_tcp` или `_udp`).
   - **Приоритет**: приоритет хоста. Чем ниже значение, тем более предпочтительный хост.
   - **Вес**: вес для хостов с одинаковым приоритетом. Чем это значение ближе к `0`, тем меньше шансов, что хост будет выбран.
   - **Порт**: номер порта, который использует служба SRV.
   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **Хост**: FQDN-хоста, на котором размещается служба. Максимальная длина — 255 символов. Должно состоять из двух или более поддоменов. Максимальная длина поддомена — 63 символа. Допустимы только цифры, латинские буквы, символы `.` и `-`.

   </details>
   <details>
    <summary>TXT</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`;
     - `\*.dns.zone` — указывает на любое имя в запросе к домену.

   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **Значение**: текстовое значение ресурсной записи.

   </details>
   <details>
    <summary>NS</summary>

   - **Имя**:

     - `@`, `example.com` или пустое значение — указывает на саму зону;
     - `subzone` или `subzone.example.com` — указывает на подзону `subzone`.

   - **Time to live (TTL)**: время жизни кеша в секундах.
   - **Значение**: адрес NS-сервера, например, `ns1.mcs.mail.ru` или `ns2.mcs.mail.ru`.

   </details>

1. Нажмите кнопку **Добавить запись**.

</tabpanel>
<tabpanel>

Воспользуйтесь методами из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

## Редактирование ресурсных записей

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Нажмите на имя зоны, для которой нужно изменить ресурсную запись.
1. Раскройте меню нужной записи и выберите пункт **Редактировать**.
1. Внесите изменения и нажмите кнопку **Сохранить изменения**.

</tabpanel>
<tabpanel>

Воспользуйтесь методами из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

## Удаление ресурсных записей

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>API</tab>
</tablist>
<tabpanel>

Это групповая операция: при необходимости можно удалить сразу несколько записей, выбрав их с помощью флажков.

1. [Перейдите](https://mcs.mail.ru/app/) в личный кабинет VK Cloud.
1. Выберите проект.
1. Перейдите в раздел **DNS** → **DNS-зоны**.
1. Нажмите на имя зоны, для которой нужно удалить ресурсную запись.
1. Раскройте меню нужной записи и выберите пункт **Удалить**.
1. Подтвердите действие.

</tabpanel>
<tabpanel>

Воспользуйтесь методами из спецификации в [справке API](/ru/additionals/api/api-dns).

</tabpanel>
</tabs>

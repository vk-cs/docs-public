<info>

На возможность обмена трафиком в подсетях и сетях может влиять не только сетевая топология, но и группы безопасности файервола.

Для упрощения изложения концепций использования маршрутизатора далее предполагается, что файервол не влияет на порты. Иными словами, весь трафик между портами разрешен.

</info>

Два порта из разных подсетей могут обмениваться трафиком друг с другом, если эти подсети принадлежат одной сети. Чтобы два порта из разных сетей могли обмениваться трафиком, необходим маршрутизатор.

Маршрутизатору при его создании или изменении можно назначить одну или несколько приватных подсетей, которые он будет связывать. Тогда в списке портов, относящихся к этим подсетям появятся порты для устройства `INTERFACE DISTRIBUTED`: это интерфейс маршрутизатора в подсетях. Таким портам будут назначены IP-адреса, указанные в настройках подсетей как адреса шлюзов.

Также при создании или изменении маршрутизатора можно включить опцию **Подключение к внешней сети**. Тогда маршрутизатор будет подключен к внешней сети `ext-net`. При этом в списке портов, относящихся к подсетям, подключенным к маршрутизатору, появятся порты для устройства `SNAT`: это интерфейс маршрутизатора в подсетях для выполнения трансляции сетевых адресов источника (Source NAT, SNAT) с использованием назначенного маршрутизатору публичного IP-адреса. Этот интерфейс необходим:

- Если нужно предоставлять порту из приватной подсети, которая подключена к маршрутизатору, доступ в интернет.

  Этот механизм полезен, если нужно предоставить порту доступ изнутри платформы VK Cloud в интернет. Например, виртуальная машина, подключенная к такому маршрутизатору, сможет выходить в интернет через интерфейс `SNAT` (допустим, для загрузки обновлений операционной системы). При этом доступа к этой виртуальной машине из интернета не будет.

- Если нужно назначить порту в приватной подсети плавающий IP-адрес.

  Это можно сделать только при условии, что внешняя сеть `ext-net` доступна из приватной подсети. Для этого маршрутизатор должен быть подключен к внешней сети.

  Этот механизм полезен, если нужно иметь возможность доступа до IP-адреса порта из интернета. Например, можно назначить публичный IP-адрес на порт, закрепленный за виртуальной машиной, чтобы подключаться к ней из интернета через SSH.

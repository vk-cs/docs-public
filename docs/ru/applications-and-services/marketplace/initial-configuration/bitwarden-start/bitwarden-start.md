Bitwarden — это корпоративный менеджер паролей, обеспечивающий безопасное хранение и совместное управление учетными данными и секретами.

Возможности Bitwarden:

- Безопасное хранение паролей и секретов: централизованное хранилище зашифрованных учетных записей, ключей API и других конфиденциальных данных на платформе VK Cloud.
- Управление доступом и разрешениями: настройка ролевой модели доступа для сотрудников.
- Генерация надежных паролей: создание уникальных сложных паролей для каждой учетной записи.
- Автозаполнение и синхронизация: расширения для браузеров и мобильных приложений, автоматическая подстановка логинов и паролей.
- Аудит и отчеты: регистрация в журнале входов в учетную запись, изменений паролей и других действий пользователей.
- Совместная работа c секретами: безопасный обмен учетными данными и секретами между командами и проектами.

{cut(Принцип работы сервиса)}
Сервис Bitwarden разворачивается на ВМ в облаке VK Cloud (self-host). При таком решении данные шифруются и хранятся на собственном защищенном сервере.

Для доступа к развернутому серверу Bitwarden используется веб-интерфейс. При подключении расширенного тарифа в веб-интерфейсе становится доступен портал администрирования. Когда пользователь с правами администратора пытается войти в систему от имени администратора, на его адрес электронной почты отправляется безопасная ссылка для авторизации. Для этого при развертывании сервиса с расширенным тарифом нужно указать все данные почтового SMTP-сервера.

Вся служебная информация: данные профилей пользователей, состав организаций, настройки, журналы событий (events) — хранится в отдельной БД MySQL. При необходимости можно получить к ней доступ, например для резервного копирования, миграции сервиса, мониторинга или аудита.
{/cut}

{cut(Минимальные технические характеристики сервера для сервиса)}

* **vCPU**: 1
* **RAM**: 2 ГБ
* Размер дисков:

    - **Системный диск**: не менее 20 ГБ
    - **Диск с данными**: не менее 15 ГБ

* **Сеть**:

    - ВМ должна иметь доступ в интернет
    - Приватный DNS должен быть выключен

{/cut}

Используя сервис Bitwarden, вы соглашаетесь с лицензионными соглашениями [Marketplace VK Cloud](/ru/start/legal/digital-cloud/marketplace) и [Bitwarden](https://bitwarden.com/help/article/open-source-license).

Чтобы развернуть сервис Bitwarden на ВМ в вашем проекте VK Cloud:

1. Запросите на [официальной странице Bitwarden](https://bitwarden.com/host) идентификатор и ключ установки. В запросе укажите почту, на которую вы хотите получать уведомления от Bitwarden, и регион `EU`.
1. [Зарегистрируйтесь](/ru/intro/onboarding/account) и [перейдите](https://msk.cloud.vk.com/app) в личный кабинет VK Cloud.
1. Чтобы иметь доступ к ВМ с развернутым сервисом и к веб-интерфейсу Bitwarden из интернета:

    1. [Создайте](/ru/networks/vnet/instructions/net#sozdanie_seti) сеть с доступом в интернет, если она не была создана ранее.
    1. В [настройках подсети](/ru/networks/vnet/instructions/net#redaktirovanie_podseti), где будет размещена ВМ с развернутым сервисом, отключите опцию **Приватный DNS**.

1. Перейдите в раздел **Магазин приложений**.
1. Нажмите на карточку сервиса **Bitwarden**.

    Если на странице нет карточки сервиса **Bitwarden**, нажмите кнопку **Все решения** и найдите карточку в каталоге.

1. Нажмите на карточку сервиса **Bitwarden**.
1. На вкладке **Описание сервиса** нажмите кнопку **Подключить**.
1. На вкладке **Тариф** выберите версию сервиса из списка.
1. Выберите подходящий тариф: `Базовый` или `Расширенный`.

    {tabs}
    {tab(Базовый тариф)}
    Предназначен для быстрого запуска сервиса с минимальными настройками.
    
    Возможности:
    
    * Регистрация пользователей через веб-интерфейс.
    * Возможность отключить регистрацию новых пользователей (через параметр **Запретить регистрацию пользователей через Web UI**).
     
    Подходит для персонального использования, небольших команд или тестирования без необходимости в централизованном управлении.
    
    {/tab}
    {tab(Расширенный тариф)}
    
    Включает все возможности базового тарифа, а также:
    
    * доступ к порталу администратора Bitwarden, где можно просматривать и удалять пользователей и организации, а также проверять текущую конфигурацию и версию системы;
    * настройку SMTP для отправки писем (например, письма для сброса пароля);
    * назначение пользователей-администраторов с доступом к порталу.
     
    Подходит для команд и организаций, которым важны расширенные возможности управления, контроль доступа и интеграция с корпоративной инфраструктурой.
    {/tab}
    {/tabs}

1.  Введите данные на странице **Параметры сервера**.
    1. Укажите параметры Bitwarden:

        - **Как будет размещен Bitwarden**: выберите тип размещения сервиса.

            - `external` — с внешним IP-адресом и доменным именем, предоставленным VK Cloud. Выберите этот тип размещения для доступа к ВМ с развернутым сервисом Bitwarden из интернета.
            - `internal` — с доступом только внутри VK Cloud.

        - **Включить резервное копирование на S3**: включите опцию, чтобы ежедневно создавать резервные копии данных Bitwarden в [объектном хранилище](/ru/storage/s3/concepts/about) VK Cloud. Хранилище создается автоматически. Сохраняются последние 7 копий.

        - **INSTALLATION ID**: укажите идентификатор установки, полученный на [официальном сайте Bitwarden](https://bitwarden.com/host).
        - **INSTALLATION KEY**: укажите ключ установки, полученный на [официальном сайте Bitwarden](https://bitwarden.com/host).

        - **Запретить регистрацию пользователей через Web UI**: отключите опцию, чтобы не блокировать регистрацию пользователя Bitwarden при первом после установки запуске сервиса. Позднее вы сможете включить эту опцию.

        - **Включить мониторинг**: включите опцию, чтобы автоматически отправлять в сервис [Cloud Monitoring](/ru/monitoring-services/monitoring) метрики виртуальной машины, на которой развернут Bitwarden. Эти метрики будут доступны в разделе **Мониторинг** личного кабинета.

    1. Укажите параметры виртуальной машины, на которой будет развернут инстанс сервиса:

        - **Сеть**: выберите сеть, где будет размещена ВМ с развернутым сервисом. Если вы указали тип размещения `external`, выберите сеть с доступом в интернет и подсеть, для которой отключена опция **Приватный DNS**.
        - **Зона доступности**: выберите [ЦОД](/ru/start/concepts/architecture#az), где будет запущена ВМ.
        - **Тип виртуальной машины**: выберите [предустановленную конфигурацию ВМ](/ru/computing/iaas/concepts/vm/flavor).

    1. Укажите параметры системного диска и диска с данными.

        - **Размер диска**: укажите нужный размер диска ВМ в гигабайтах.
        - **Тип диска**: выберите [один из типов диска](/ru/computing/iaas/concepts/data-storage/disk-types#disk_types) — `HDD`, `SSD` или `High-IOPS SSD`.

1.  Нажмите кнопку **Следующий шаг**.
1.  Если вы выбрали тариф `Расширенный`, укажите расширенные параметры сервиса: 

    - **SMTP User**: укажите пользователя, от имени которого будут отправляться письма пользователям Bitwarden.
    - **SMTP Password**: укажите пароль пользователя, от имени которого будут отправляться письма пользователям Bitwarden.
    - **SMTP Host**: укажите адрес SMTP-сервера, с которого будут отправляться письма, например `smtp.gmail.com`.
    - **SMTP Port**: укажите порт SMTP-сервера в соответствии с документацией вашего SMTP-провайдера, например `587`.
    - **SMTP SSL**: включите или отключите опцию в соответствии с документацией вашего SMTP-провайдера.
    - **Администрирование**: укажите через запятую адреса почты пользователей, которым будет разрешен доступ к управлению сервисом Bitwarden.

    Получить настройки SMTP можно у вашего провайдера.

1.  Ознакомьтесь со стоимостью инфраструктуры для развертывания сервиса и нажмите кнопку **Подключить тариф**.

    Начнется развертывание облачной инфраструктуры, и откроется страница свойств сервиса. Статус процесса будет отображаться также в разделе **Магазин приложений → Мои сервисы**.

    После успешного развертывания на почту, привязанную к вашему аккаунту в VK Cloud, придут сообщения:

    - уведомление со ссылкой на инстанс сервиса в личном кабинете VK Cloud;
    - письмо с одноразовой ссылкой на данные для доступа к сервису.

1.  Перейдите по одноразовой ссылке из письма и сохраните данные для доступа к сервису:

    - `bitwarden_admin_url` — ссылка для доступа к веб-интерфейсу Bitwarden.
    - `bitwarden_db_pass` — пароль для доступа к базе данных Bitwarden, в которой хранится служебная информация сервиса (данные профилей пользователей, состав организаций, настройки, журналы событий).
    - `os_service_user` — логин для запуска и управления сервисом Bitwarden на ВМ с развернутым экземпляром сервиса.
    - `bitwarden_os_service_user_pass` — пароль для подключения к  `os_service_user`.
    - `os_user` — логин для подключения по SSH к ВМ, на которой развернут экземпляр сервиса, так как согласно политике безопасности Bitwarden нельзя использовать логин по умолчанию (`ubuntu`). Это может понадобиться для обновления операционной системы, настройки файервола, мониторинга и других задач администрирования ВМ с развернутым сервисом.
    - `keypair` — приватный SSH-ключ для подключения к ВМ, на которой развернут экземпляр сервиса.

    {note:info}

    Если данные для доступа утрачены, [сгенерируйте](../../instructions/pr-instance-manage#update_access) новые.

    {/note}

1.  Используйте нужный вариант для первого после установки сервиса входа в веб-интерфейс Bitwarden:

    {tabs}
    {tab(Вход в качестве пользователя)}

    1. Убедитесь, что в настройках вашего экземпляра сервиса Bitwarden отключена опция **Запретить регистрацию пользователей через Web UI**:

        1. В личном кабинете VK Cloud перейдите в раздел **Магазин приложений** → **Мои сервисы**.
        1. Нажмите на имя вашего экземпляра сервиса Bitwarden.
        1. Перейдите на вкладку **Тарифные планы** и нажмите кнопку **Настроить тариф**.
        1. Отключите опцию **Запретить регистрацию пользователей через Web UI**, если она включена, и сохраните изменения.

    1. Перейдите по ссылке из `bitwarden_admin_url`.
    1. Нажмите кнопку создания нового аккаунта.
    1. Укажите почту и мастер-пароль.
    
    {/tab}
    {tab(Вход на портал администрирования)}
    
    {note:info}

    Доcтуп на портал администрирования возможен только при подключении тарифа `Расширенный`.

    {/note}
    
    1. Перейдите по ссылке из `bitwarden_admin_url`, добавив к адресу `/admin`, например `https:/<bitwarden_admin_url>/admin`  
    1. Укажите свою почту, которую указывали в поле **Администрирование**.
    
        После этого на указанную почту придет письмо от Bitwarden с одноразовым приглашением перейти на портал администрирования.

    7. Перейдите по ссылке из письма от Bitwarden.
   

    {/tab}
    {/tabs}

1. Настройте запрет регистрации пользователей через Web UI для развернутого экземпляра сервиса Bitwarden:

    1. В личном кабинете VK Cloud перейдите в раздел **Магазин приложений** → **Мои сервисы**.
    1. Нажмите на имя вашего экземпляра сервиса Bitwarden.
    1. Перейдите на вкладку **Тарифные планы** и нажмите кнопку **Настроить тариф**.
    1. Включите опцию **Запретить регистрацию пользователей через Web UI** и сохраните изменения.

1. (Опционально) Воспользуйтесь [официальной документацией Bitwarden](https://bitwarden.com/help/), чтобы начать работу с сервисом.

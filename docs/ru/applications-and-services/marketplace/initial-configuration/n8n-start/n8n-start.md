n8n — это платформа автоматизации процессов с интеграцией внешних сервисов и построением цепочек действий без программирования. В n8n вы собираете процесс из двух типов узлов: триггеров и действий. Триггер запускает процесс, далее узлы действий получают и преобразуют данные, отсылают запросы во внешние API или обращаются к подключенным сервисам.

Возможности n8n:

- Автоматизация рабочих процессов: создание процессов любой сложности с помощью узлов и связей между ними.
- Работа без кода: управление рабочими процессами с помощью визуального редактора.
- Планировщик и регулярные задачи: периодическая синхронизация данных между подключенными к процессу сервисами, регулярный сбор данных из этих сервисов, их агрегация и отправка отчетов на почту или в мессенджеры.
- История запусков и отладка процессов: просмотр событий, логов, входных и выходных данных, повторный запуск процессов в режиме отладки.
- Интеграция с внешними сервисами: поддержка REST API, вебхуков, а также популярных сервисов, таких как Google Sheets, Slack, Telegram и т.п.
- Экспорт и импорт: удобный перенос настроенных процессов между инстансами.

Используя n8n, вы соглашаетесь с лицензионными соглашениями [Marketplace](/ru/intro/start/legal/marketplace) и [n8n Sustainable Use License](https://docs.n8n.io/sustainable-use-license).

## 1. Разверните n8n в проекте VK Cloud

1. [Зарегистрируйтесь](/ru/intro/start/account-registration) и [перейдите](https://msk.cloud.vk.com/app) в личный кабинет VK Cloud.

1. Перейдите в раздел **Магазин приложений**, на странице раздела нажмите кнопку **Все решения**.

1. Нажмите на карточку сервиса **n8n**.

1. На странице с описанием сервиса нажмите кнопку **Подключить**.

1. Введите данные на странице **Параметры сервера**.

    1. Укажите, как будет размещен сервис:

        - `external` — с внешним IP-адресом и именем в домене `*.xaas.msk.bizmrg.com` для доступа к сервису из интернета.
        - `internal` — с доступом только по внутреннему IP-адресу.
    1. Включите резервное копирование на S3, чтобы ежедневно создавать резервные копии данных n8n в [объектном хранилище VK Cloud](/ru/storage/s3/concepts/about). Хранилище создается автоматически. Сохраняются последние 7 копий.

    1. Укажите внешний IP-адрес, с которого вы планируете подключаться к интерфейсу n8n, в формате `XXX.XXX.XXX.XXX`. Для доступа с любых адресов укажите `0.0.0.0`. Добавлять маску не требуется.

        В дальнейшем вы можете [изменить настройки доступа](#edit_access).
    1. Включите мониторинг, чтобы метрики виртуальной машины автоматически отправлялись в [Cloud Monitoring](/ru/monitoring-services/monitoring) и были доступны в личном кабинете VK Cloud в разделе **Мониторинг**.

    1. Укажите параметры виртуальной машины, на которой будет развернут инстанс сервиса:

        - **Сеть**: создайте новую сеть или выберите существующую сеть с доступом в интернет и подсеть, в которой отключен **Приватный DNS**.
        - **Зона доступности**: выберите [ЦОД](/ru/start/concepts/architecture#az), где будет запущена ВМ.
        - **Тип виртуальной машины**: выберите [предустановленную конфигурацию ВМ](/ru/computing/iaas/concepts/vm/flavor). Для пилотных сценариев достаточно шаблона конфигурации по умолчанию. При росте числа процессов и частоты запусков вы можете увеличить ресурсы, [отредактировав тариф](/ru/applications-and-services/marketplace/instructions/pr-instance-manage#redaktirovanie_tarifnogo_plana).

    1. Укажите параметры системного диска и диска с данными:

        - **Размер диска**: укажите нужный размер диска ВМ в гигабайтах.
        - **Тип диска**: [один из типов диска](/ru/computing/iaas/concepts/data-storage/disk-types#disk_types) — `HDD`, `SSD` или `High-IOPS SSD`.

1. Нажмите кнопку **Следующий шаг**.

1. Ознакомьтесь со стоимостью инфраструктуры и нажмите кнопку **Подключить тариф**.

    Начнется развертывание облачной инфраструктуры, и откроется страница свойств сервиса. Статус будет отображаться в разделе **Магазин приложений → Мои сервисы**.

    После успешного развертывания на вашу почту, привязанную к VK Cloud, придет уведомление об успешном подключении сервиса и письмо с одноразовой ссылкой на данные для доступа к сервису.

1. Перейдите по одноразовой ссылке из письма и сохраните параметры подключения:

    - `ingress_ip` — IP-адрес, с которого разрешен доступ к сервису;
    - `keypair` — приватный ключ для подключения по SSH к виртуальной машине, где развернут сервис;
    - `n8n_db_admin` — логин администратора для доступа к БД n8n;
    - `n8n_db_admin_pass` — пароль администратора для доступа к БД n8n;
    - `n8n_db_user` — логин пользователя для доступа к БД n8n;
    - `n8n_db_user_pass` — пароль пользователя для доступа к БД n8n;
    - `n8n_url` — ссылка на веб-интерфейс n8n;  
    - `os_user` — имя системного пользователя для подключения по SSH к виртуальной машине, где развернут сервис.

    {note:info}

    Если данные для доступа утрачены, [сгенерируйте](../../instructions/pr-instance-manage#update_access) новые.

    {/note}

## 2. Начните работу в сервисе

1. Перейдите в веб-интерфейс сервиса по адресу `http://<АДРЕС_СЕРВИСА>`, где `<АДРЕС_СЕРВИСА>` — URL или IP-адрес веб-интерфейса n8n.

1. При первом входе создайте учетную запись владельца — это пользователь с максимальными привилегиями инстанса n8n.

1. Создайте первый процесс:

    1. Нажмите **Create workflow**.
    1. Нажмите **Add first step** и добавьте триггер (например, **Trigger manually** или **On a schedule**).
    1. Добавьте действие. Например, выберите **Core → HTTP request**, чтобы добавить запрос по HTTP к любому серверу.
    1. Нажмите **Execute workflow**, чтобы выполнить тестовый запуск процесса, и убедитесь, что данные проходят по созданной цепочке.
    1. Нажмите **Activate**, чтобы активировать и сохранить процесс, если он должен работать постоянно.

1. (Опционально) Пригласите пользователей и настройте совместную работу, воспользовавшись [официальной документацией n8n](https://docs.n8n.io/hosting/configuration/user-management-self-hosted).

    {note:info}
    Для приглашения пользователей и сброса паролей рекомендуется настроить SMTP. Вы также можете вручную отправлять приглашения, но тогда сброс паролей будет недоступен.
    {/note}

1. (Опционально) Воспользуйтесь [официальными руководствами](https://docs.n8n.io), чтобы начать работу с n8n:

    - [Быстрый старт](https://docs.n8n.io/try-it-out/quickstart).
    - [Создание первого процесса](https://docs.n8n.io/try-it-out/tutorial-first-workflow).
    - [Управление пользователями](https://docs.n8n.io/user-management).
    - [Настройка сервиса для работы вебхуков с обратными прокси](https://docs.n8n.io/hosting/configuration/configuration-examples/webhook-url).

## {heading(3. (Опционально) Измените настройки сетевого доступа)[id=edit_access]}

Если вы хотите изменить настройки доступа к сервису с определенных IP-адресов, отредактируйте правила групп безопасности:

1. [Перейдите](https://msk.cloud.vk.com/app) в личный кабинет VK Cloud.
1. Перейдите в раздел **Виртуальные сети → Настройки firewall**.
1. Нажмите на название группы безопасности инстанса вашего сервиса. Название будет иметь вид `8f9b4adf-n8n`, где `8f9b4adf` — первая часть [ID инстанса](/ru/applications-and-services/marketplace/instructions/pr-instance-manage#prosmotr_informacii_ob_instanse_servisa).
1. [Добавьте новые правила](/ru/networks/vnet/instructions/secgroups#add_rule) в группу безопасности или [удалите неактуальные](/ru/networks/vnet/instructions/secgroups#delete_rule). Если вы планируете использовать вебхуки, разрешите доступ для IP-адресов или диапазонов адресов внешних сервисов, которые будут отсылать запрос в n8n.

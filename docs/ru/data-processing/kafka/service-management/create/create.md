Вы можете создать экземпляр Cloud Kafka в одной из двух конфигураций:

- [Single](#sozdanie_ekzemplyara_v_konfiguracii_single): конфигурация из одного узла, не отказоустойчивая. Экземпляр в такой конфигурации подходит для задач разработки и тестирования.
- [Кластер](#sozdanie_ekzemplyara_v_konfiguracii_klaster): отказоустойчивая конфигурация из нескольких узлов. Экземпляр в такой конфигурации подходит для любых задач, в том числе для повседневной работы с данными в production-среде.

## Создание экземпляра в конфигурации Single

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где нужно создать экземпляр сервиса.
1. Перейдите в раздел **Data Platform → Экземпляры сервисов**.
1. Нажмите кнопку **Добавить инстанс** или **Создать экземпляр**.
1. На шаге «Конфигурация»:

   1. Выберите тип сервиса **Kafka**.
   1. Выберите нужную версию сервиса.
   1. Выберите конфигурацию **Single**.
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Параметры»:

   1. Задайте для экземпляра название и описание.
   1. Задайте параметры узла для брокера:

      - **Тип инстанса:** [шаблон конфигурации](/ru/base/iaas/concepts/about#shablony_konfiguraciy) для узла.
      - **Тип диска:** [тип диска](/ru/base/iaas/concepts/about#tipy_diskov_c23be93f) для узла.
      - **Размер диска:** размер диска для узла.

   1. Выберите кластер Kubernetes. В этот кластер [Cloud Containers](/ru/base/k8s) будет добавлен [worker-узел](/ru/base/k8s/concepts/architecture#topologii_klastera) для размещения экземпляра Cloud Kafka.

      Если нужного кластера нет в списке:

      1. Выберите пункт **Создать новый кластер**.
      1. Выберите сеть и подсеть для кластера из выпадающего списка **Сеть**.

         Если нужной сети нет в списке:

         1. Выберите пункт **Создать новую сеть**.
         1. Выберите нужную [SDN](/ru/networks/vnet/concepts/architecture#ispolzuemye_sdn): **Neutron** или **Sprut**.
         1. Задайте адрес подсети, например, `10.0.1.0/24`.

   1. Выберите [зону доступности](/ru/additionals/start/architecture#az), где будет размещен узел кластера Cloud Containers.
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Учетные данные»:

   1. Задайте логин администратора для доступа к Kafka.
   1. Придумайте или сгенерируйте пароль администратора.

      Требования к паролю:

      - может содержать только цифры, символы из диапазона `!"#$%&()*+,.:;<=>?@[]^_{|}~-`, заглавные и строчные латинские буквы;
      - должен состоять как минимум из 8 символов;
      - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

      <err>

      Восстановить пароль нельзя.

      </err>

   1. Нажмите кнопку **Создать**.

      Дождитесь завершения операции. Создание экземпляра Cloud Kafka может занять длительное время.

</tabpanel>
</tabs>

## Создание экземпляра в конфигурации Кластер

<tabs>
<tablist>
<tab>Личный кабинет</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где нужно создать экземпляр сервиса.
1. Перейдите в раздел **Data Platform → Экземпляры сервисов**.
1. Нажмите кнопку **Создать инстанс** или **Создать экземпляр**.
1. На шаге «Конфигурация»:

   1. Выберите тип сервиса **Kafka**.
   1. Выберите нужную версию сервиса.
   1. Выберите конфигурацию **Кластер**.
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Параметры»:

   1. Задайте для экземпляра название и описание.
   1. Выберите кластер Kubernetes. В этот кластер [Cloud Containers](/ru/base/k8s) будет добавлен [worker-узел](/ru/base/k8s/concepts/architecture#topologii_klastera) для размещения экземпляра Cloud Kafka.

      Если нужного кластера нет в списке:

      1. Выберите пункт **Создать новый кластер**.
      1. Выберите сеть и подсеть для кластера из выпадающего списка **Сеть**.

         Если нужной сети нет в списке:

         1. Выберите пункт **Создать новую сеть**.
         1. Выберите нужную [SDN](/ru/networks/vnet/concepts/architecture#ispolzuemye_sdn): **Neutron** или **Sprut**.
         1. Задайте адрес подсети, например, `10.0.1.0/24`.

   1. Выберите [зону доступности](/ru/additionals/start/architecture#az), где будет размещен узел кластера Cloud Containers.
   1. Настройте параметры узлов кластера, выбрав одну из опций:

      <tabs>
      <tablist>
      <tab>Базовая</tab>
      <tab>Продвинутая</tab>
      </tablist>
      <tabpanel>

      Выберите один из готовых шаблонов кластера. [Шаблон конфигурации](/ru/base/iaas/concepts/about#shablony_konfiguraciy) и [тип диска](/ru/base/iaas/concepts/about#tipy_diskov_c23be93f) для узлов кластера уже выбраны.

      При выборе любого шаблона экземпляр Cloud Kafka будет состоять из трех узлов для брокеров и трех узлов для ZooKeeper.

      </tabpanel>
      <tabpanel>

      Настройте параметры самостоятельно:

      1. Задайте в блоке **Broker** параметры узлов для брокеров:

         - **Тип инстанса:** [шаблон конфигурации](/ru/base/iaas/concepts/about#shablony_konfiguraciy) для узла.
         - **Тип диска:** [тип диска](/ru/base/iaas/concepts/about#tipy_diskov_c23be93f) для узла.
         - **Размер диска:** размер диска для узла.
         - **Количество broker:** общее количество узлов.

           Минимальное количество узлов — три.

         - **Коэффициент репликации:** коэффициент репликации ([replication factor](https://kafka.apache.org/documentation/#intro_concepts_and_terms)) по умолчанию.

           Минимальное значение коэффициента совпадает с выбранным количеством узлов для брокеров.

           Этот коэффициент применяется при создании топиков Kafka (topics), если для них не был явно указан коэффициент репликации.

      1. Ознакомьтесь с параметрами узлов для ZooKeeper.

         Эти параметры преднастроены, и их нельзя изменить.

      </tabpanel>
      </tabs>

   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Учетные данные»:

   1. Задайте логин администратора для доступа к Kafka.
   1. Придумайте или сгенерируйте пароль администратора.

      Требования к паролю:

      - может содержать только цифры, символы из диапазона `!"#$%&()*+,.:;<=>?@[]^_{|}~-`, заглавные и строчные латинские буквы;
      - должен состоять как минимум из 8 символов;
      - должен содержать хотя бы одну заглавную и одну строчную букву латинского алфавита, хотя бы одну цифру.

      <err>

      Восстановить пароль нельзя.

      </err>

   1. Нажмите кнопку **Создать**.

      Дождитесь завершения операции. Создание экземпляра Cloud Kafka может занять длительное время.

</tabpanel>
</tabs>

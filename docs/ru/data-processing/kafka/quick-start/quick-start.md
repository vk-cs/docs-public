Быстрый старт поможет начать работу с сервисом и познакомиться с его возможностями.

Пройдя все шаги быстрого старта, вы:

1. Создадите экземпляр Cloud Kafka в конфигурации **Single**.
1. Научитесь отправлять сообщения в топик ([topic](https://kafka.apache.org/documentation/#intro_concepts_and_terms)) и получать сообщения из топика экземпляра Cloud Kafka.

<warn>

Экземпляр Cloud Kafka [тарифицируется](../tariffication) и потребляет вычислительные ресурсы. После прохождения быстрого старта [удалите экземпляр сервиса](#udalite_neispolzuemye_resursy), если он вам больше не нужен.

</warn>

## 1. Создайте экземпляр сервиса Cloud Kafka

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где нужно создать экземпляр сервиса.
1. Перейдите в раздел **Платформа данных → Экземпляры сервисов**.
1. Нажмите кнопку **Создать экземпляр**.
1. На шаге «Конфигурация»:

   1. Выберите тип сервиса **Kafka**.
   1. Выберите версию **3.5.0**.
   1. Выберите конфигурацию **Single**.
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Параметры»:

   1. Задайте для экземпляра название и описание: `vkcloud-demo-kafka` и `Первый экземпляр Cloud Kafka`.
   1. Задайте параметры узла для брокера:

      - **Тип виртуальной машины:** `Standard-2-4`.
      - **Тип диска:** `High-IOPS SSD`.
      - **Размер диска:** `50 ГБ`.

   1. **Кластер Kubernetes**: выберите пункт **Создать новый кластер**.
   1. **Сеть**: выберите пункт **Создать новую сеть**.
   1. Выберите **Neutron** в качестве SDN.
   1. **Адрес подсети**: укажите `10.0.1.0/24`.
   1. **Зона доступности**: `Москва (GZ1)`.
   1. Нажмите кнопку **Следующий шаг**.

1. На шаге «Учетные данные»:

   1. **Логин администратора для доступа к Kafka**: например, `kafkaadmin`.
   1. **Пароль администратора для доступа к Kafka**: нажмите кнопку **Сгенерировать** и сохраните полученный пароль.

      <err>

      Восстановить пароль нельзя.

      </err>

   1. Нажмите кнопку **Создать**.

      Дождитесь завершения операции. Создание экземпляра Cloud Kafka может занять длительное время.

## 2. Подготовьтесь к работе с экземпляром Cloud Kafka

1. Получите доступ к консольным клиентам Kafka на хосте, с которого планируется работать с экземпляром сервиса:

   <tabs>
   <tablist>
   <tab>Linux (bash) / macOS (zsh)</tab>
   </tablist>
   <tabpanel>

   1. Убедитесь, что на хосте установлена версия Java 11 или выше:

      ```bash
      java --version
      ```

      Если вывод содержит `Command 'java' not found` или версия устарела, установите Java Development Kit (JDK), например, [OpenJDK](https://openjdk.org/install/). Можно установить как JDK целиком, так и только Java Runtime Environment (JRE).

      Пример установки OpenJDK 11 (только JRE) с помощью `apt` для Ubuntu 22.04 LTS:

      ```bash
      sudo apt update && sudo apt install openjdk-11-jre
      ```

   1. [Загрузите архив](https://archive.apache.org/dist/kafka/3.5.0/kafka_2.13-3.5.0.tgz) с дистрибутивом Kafka версии 3.5.0. Версии Kafka для экземпляра сервиса и на хосте должны совпадать. Пример команды для загрузки дистрибутива с помощью cURL:

      ```bash
      curl -O https://archive.apache.org/dist/kafka/3.5.0/kafka_2.13-3.5.0.tgz
      ```

   1. Распакуйте архив и перейдите в директорию с распакованными файлами:

      ```bash
      tar -xzf kafka_2.13-3.5.0.tgz && cd kafka_2.13-3.5.0
      ```

   1. Получите версию консольного клиента-производителя (producer) и консольного клиента-потребителя (consumer):

      ```bash
      bin/kafka-console-producer.sh --version
      bin/kafka-console-consumer.sh --version
      ```

      Успешный вывод версии свидетельствует о корректно работающих клиентах.

   1. Создайте конфигурационный файл `client-ssl.properties` с содержимым:

      ```ini
      security.protocol=SSL
      ```

      Этот файл содержит в себе [настройку](https://kafka.apache.org/documentation/#security_configclients), которая требует от клиента-производителя и клиента-потребителя аутентифицироваться в экземпляре сервиса с помощью протокола SSL.

   </tabpanel>
   </tabs>

1. Получите адрес bootstrap-сервера для подключения к экземпляру сервиса:

   1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
   1. Выберите проект, где находится экземпляр сервиса.
   1. Перейдите в раздел **Платформа данных → Экземпляры сервисов**.
   1. Откройте страницу кластера `vkcloud-demo-kafka`, нажав на его имя.
   1. Перейдите на вкладку **Общая информация**.
   1. Запишите адрес из параметра **Bootstrap**.

   <info>

   Далее для примера используется адрес `kafka-bootstrap.example.com:9093`.

   Замените его на реальный адрес bootstrap-сервера в командах ниже.

   </info>

## 3. Отправьте сообщение в топик и получите его

<tabs>
<tablist>
<tab>Linux (bash) / macOS (zsh)</tab>
</tablist>
<tabpanel>

1. Создайте отдельную сессию терминала, в которой будет работать консольный клиент.
1. Запустите в этой сессии клиент-потребитель и укажите в качестве источника топик `test`. Клиент-потребитель будет подключаться к экземпляру Cloud Kafka, используя полученный ранее адрес bootstrap-сервера и файл конфигурации, и непрерывно читать и выводить сообщения из топика. Новый топик будет создан автоматически при первом обращении к нему.

   Для этого выполните команду:

   ```bash
   bin/kafka-console-consumer.sh \
     --bootstrap-server kafka-bootstrap.example.com:9093 \
     --consumer.config client-ssl.properties \
     --topic test
   ```

1. Создайте еще одну сессию терминала, в которой будет работать другой консольный клиент.
1. Запустите в этой сессии клиент-производитель и укажите в качестве приемника топик `test`. Клиент-потребитель будет подключаться к экземпляру Cloud Kafka, используя полученный ранее адрес bootstrap-сервера и файл конфигурации, и отправлять вводимые сообщения в топик.

   Для этого выполните команду:

   ```bash
   bin/kafka-console-producer.sh \
     --broker-list kafka-bootstrap.example.com:9093 \
     --producer.config client-ssl.properties
     --topic test
   ```

1. В сессии терминала с клиентом-производителем введите тестовое сообщение и затем нажмите _Enter_:

   ```text
   This is the test message.
   ```

1. Проверьте, что в сессии терминала с клиентом-потребителем отображается отправленное тестовое сообщение:

   ```text
   This is the test message.
   ```

   Наличие сообщения означает, что экземпляр Cloud Kafka работает корректно.

1. Завершите работу клиентов, нажав комбинацию клавиш CTRL+C в обеих сессиях терминала.

</tabpanel>
</tabs>

## Удалите неиспользуемые ресурсы

Экземпляр Cloud Kafka [тарифицируется](../tariffication) и потребляет вычислительные ресурсы. Если он вам больше не нужен, удалите его.

Также вы можете удалить конфигурационный файл `client-ssl.properties` и загруженный дистрибутив Kafka.

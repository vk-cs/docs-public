# {heading(Обновление SaaS-приложения)[id=saas_update]}

Обновление конфигурации SaaS-приложения может включать:

* Изменение параметров тарифных планов и опций.
* Добавление тарифных планов и опций.
* Удаление тарифных планов и опций.

Чтобы обновить SaaS-приложение в {var(sys6)}:

1. Отредактируйте файл с конфигурацией сервиса.

   1. Чтобы сохранить текущую опубликованную ревизию сервиса доступной в тестовых пространствах имен {var(sys2)}, в JSON-файл вставьте новую секцию для описания новой конфигурации сервиса:

      {caption(null)[align=left;position=above]}
      ```json
      {
        "services": [
          {
          <SERVICE_PARAMETERS>,
          "preview": {
              "parameters": [
              ]
            },
          "plans": [
            ]
          },
          {
          <SERVICE_PARAMETERS>,
          "preview": {
              "parameters": [
              ]
            },
          "plans": [
            ]
          }
        ]
      }
      ```
      {/caption}

      Если текущую ревизию сервиса не требуется сохранить доступной в тестовом пространстве имен {var(sys2)}, то пропустите этот шаг.
   1. Опишите новую конфигурацию сервиса (подробнее — в разделе [Конфигурация SaaS-приложения](../saas_add/saas_configure)).
   1. В новой конфигурации сервиса укажите новую ревизию сервиса.

      <warn>

      Сервис не будет обновлен, если указанная ревизия сервиса уже загружена в {var(sys1)}.

      </warn>
   1. Если были изменены параметры тарифных планов, то в новой конфигурации сервиса укажите новые ревизии планов.

      <warn>

      Тарифные планы не будут обновлены, если указанные ревизии планов уже загружены в {var(sys1)}.

      </warn>

1. Если были добавлены или удалены тарифные планы, то отредактируйте файл `resources/plan_mapping.json` в директории брокера (подробнее — в разделе {linkto(#saas_broker_add_configuration)[text=%text]}).
1. {var(sys1)} периодически запрашивает у брокера текущую конфигурацию сервиса, поэтому новая конфигурация автоматически попадет в тестовое пространство имен {var(sys2)}.

   <err>

   Чтобы {var(sys1)} мог получать текущую конфигурацию сервиса, брокер должен быть доступен круглосуточно.

   </err>
1. Протестируйте новую ревизию сервиса в тестовом пространстве имен {var(sys2)} (подробнее — в разделе {linkto(#saas_upload_testmarketplace)[text=%text]}).
1. Опубликуйте новую ревизию сервиса в открытом пространстве имен {var(sys2)} (подробнее — в разделе {linkto(#saas_upload_publish)[text=%text]}).

   Предыдущая опубликованная ревизия переходит в тестовое пространство имен {var(sys2)}, если она сохранена в файле с конфигурацией сервиса. В тестовых пространствах имен сохраняются все неопубликованные ревизии, описанные в конфигурации сервиса.

   Ревизии сервиса, удаленные из конфигурации сервиса, не будут доступны ни в тестовых, ни в открытых пространствах имен {var(sys2)}.

   Публикация новой ревизии не влияет на уже существующие инстансы (тенанты/аккаунты) сервиса. Ревизия этих инстансов сервиса не изменяется, даже если она удалена из конфигурации сервиса и недоступна в {var(sys6)}.

На платформе VK Cloud доступны три типа конфигураций инстансов СУБД. Типа конфигурации определяет, какое количество инстансов БД будет создано и их архитектуру.

Для любого типа конфигурации может быть создана реплика — дополнительный инстанс для [репликации](../../instructions/replication). Тип диска реплики и его размер может отличаться от мастера и задается отдельно.

Реплика может быть преобразована в мастер. В этом случае репликация прекратится, и инстанс превратится в независимый мастер-инстанс, доступный для чтения и записи. Новый мастер-инстанс будет содержать те же данные, что и реплика до конвертации в мастер.

По умолчанию реплики и мастер размещаются в одном ЦОД. Чтобы перенести один из инстансов в другой ЦОД, обратитесь в [техническую поддержку](/ru/contacts).

## {heading(Single)[id=single]}

Одна виртуальная машина с установленным сервером СУБД выбранного типа. В такой конфигурации инстанс можно останавливать, запускать и перезапускать.

## {heading(Master-Replica)[id=master-replica]}

Две виртуальные машины с установленными серверами СУБД выбранного типа. Инстансы поддерживают синхронную репликацию в режиме `master-replica` (active-passive) и масштабируются отдельно.

Инстанс в конфигурации Master-Replica можно останавливать, запускать и перезапускать.

## {heading(Кластер)[id=cluster]}

Группа виртуальных машин с установленными серверами СУБД выбранного типа, поддерживающие синхронную и асинхронную репликацию данных, с балансировщиком нагрузки. При недоступности мастер-инстанса сработает автоматическое переключение: одна из реплик конвертируется в мастер, а вместо нее будет создана еще одна реплика.

Чтобы повысить отказоустойчивость кластера PostgreSQL, синхронные и асинхронные реплики можно распределять по другим зонам, выбрав [мультизональную конфигурацию](#multi-az). Для обеспечения высокой доступности кластера PostgreSQL используется служба [Patroni](https://patroni.readthedocs.io/en/latest/index.html).

При увеличении размера диска или вертикальном масштабировании изменения применяются ко всем инстансам кластера.

В этой конфигурации инстанс нельзя запустить, перезапустить или остановить.

## {heading(Мультизональный кластер)[id=multi-az]}

{note:info}

Конфигурация мультизонального кластера доступна только для инстансов PostgreSQL версии 16.

{/note}

Отказоустойчивое решение, аналогичное конфигурации [Кластер](#cluster). Группа виртуальных машин с установленными серверами СУБД распределена между [зонами доступности](/ru/start/concepts/architecture#az).

Такая конфигурация обеспечивает максимальную доступность и автоматическое восстановление даже при сбое всего ЦОД, что критично для высоконагруженных проектов и сохранности данных.

Для обеспечения высокой отказоустойчивости кластер должен содержать нечетное количество узлов, включая master-узел. Это нужно для корректной работы алгоритма согласования данных между узлами (Raft). Согласно этому алгоритму, при выходе из строя ЦОД оставшиеся узлы должны образовывать большинство:

- Если количество оставшихся узлов меньше или равно количеству узлов, вышедших из строя, большинство не образуется. В результате новый master-узел не может быть назначен, а значит, кластер не может принимать новые транзакции. Кластер переходит в режим только для чтения для сохранности данных.
- Если количество оставшихся узлов больше, чем количество вышедших из строя узлов, образуется большинство. Назначается новый master-узел, кластер продолжает работу.

Нечетное количество узлов позволяет минимизировать вероятность возникновения ситуации, при которой большинство не образуется.

## {heading(Доступные конфигурации для типов СУБД)[id=available-configs]}

[cols="1,1,1,1", options="header"]
|===
| Тип СУБД 
| Single 
| Master-Replica 
| Кластер

| MySQL
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/check.svg "inline")

| Tarantool
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/no.svg "inline") 
| ![](/ru/assets/check.svg "inline")

| PostgreSQL
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/check.svg "inline") 

| ClickHouse
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/no.svg "inline")
| ![](/ru/assets/check.svg "inline")

| Redis
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/no.svg "inline") 
| ![](/ru/assets/check.svg "inline")

| MongoDB
| ![](/ru/assets/check.svg "inline") 
| ![](/ru/assets/no.svg "inline") 
| ![](/ru/assets/check.svg "inline")

| OpenSearch
| ![](/ru/assets/no.svg "inline") 
| ![](/ru/assets/no.svg "inline") 
| ![](/ru/assets/check.svg "inline")
|===

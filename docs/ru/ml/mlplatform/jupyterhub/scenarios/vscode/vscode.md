Данная инструкция поможет вам подключиться к серверу JupyterHub в облаке, используя VS Code, установленный на вашем локальном рабочем месте. Таким образом, вы можете использовать мощные сервера в облаке, которые превосходят ваш локальный ноутбук, для запуска ресурсоемких вычислений.

Вы можете развернуть JupyterHub в облаке на ВМ с несколькими GPU, десятками ядер и сотнями гигабайт оперативной памяти.

Для начала работы с JupyterHub через Visual Studio Code на вашем локальном компьютере, выполните шаги:

1. Получите JupyterHub access token.

    <info>

    JupyterHub позволяет создавать собственные токены для использования сторонними приложениями. Эти токены можно использовать везде, где требуется токен доступа Jupyter Notebook. Данный токен необходим Visual Studio Code.

    </info>

    1. Авторизуйтесь в JupyterHub, введя свой логин и пароль.

    1. Перейдите в Hub Control Panel. Данный пункт можно найти, выбрав **File -> Hub Control Panel**. Затем перейдите на вкладку **Token**, выбрав этот пункт в верхней части меню.

    1. Введите описание нового токена, выберите срок действия токена и нажмите «Request new API token».

    1. Скопируйте сгенерированный токен и сохраните его в безопасном месте. Вы должны рассматривать его как пароль для вашего JupyterHub. Вы можете и должны отозвать токен, используя этот же раздел Hub Control Panel, когда вы прекратите его использовать.

1. Подключите VS Code к инстансу JupyterHub в облаке.

    1. Откройте командную строку (command palette) в Visual Studio Code («Cmd+Shift+P» в MacOS, «Ctrl+Shift+P» в других ОС).

    1. Выберите пункт «Python: Specify local or remote Jupyter server for connections».

    1. Сгенерируйте URL сервера вида `https://<your-hub-url>/jh/user/<your-hub-user-name>/?token=<your-token>`.

        Пример:

        ```
        https://ml-platform-3c000000000000.ml.msk.vkcs.cloud/jh/user/admin/?token=000f00bdf7d00fbd0000000c0006ebfd
        ```

        <warn>

        Обратите внимание, что ваше имя пользователя JupyterHub может быть экранировано, если оно содержит специальные символы. Правильное имя пользователя для составления URL сервера можно увидеть в строке браузера после части `/user/`.

        В нашем примере это `admin`:

        ```
        https://ml-platform-3c000000000000.ml.msk.vkcs.cloud/jh/user/admin/lab
        ```

        </warn>

1. (Опционально) Установите расширение [Jupyter Extension](https://devblogs.microsoft.com/python/introducing-the-jupyter-extension-for-vs-code/) для VS Code.
1. Проверьте созданное подключение.

    Создайте или откройте новый Notebook в VS Code. Kernel для него теперь будет запущен на вашем облачном JupyterHub.

    Вы можете проверить это, выполнив команду `!hostname`, которая должна вернуть имя хоста вашего удаленного сервера JupyterHub вместо вашего локального имени хоста.

    Вы также можете попробовать импортировать библиотеки, которые находятся на удаленном сервере JupyterHub, но не в вашем локальном окружении.

    <info>

    Удаленный сервер JupyterHub для пользователя уже должен быть запущен, когда вы пытаетесь открыть Notebook — Visual Studio Code не запустит его автоматически. Если он остановлен, вам нужно войти в свой JupyterHub и запустить его снова. При этом вам не нужен новый токен.

    </info>

    <warn>

    Следите за доступом к файловой системе. Когда вы вызываете `open()` (или вспомогательную функцию, которая в конечном итоге обращается к файлу для чтения), он будет прочитан из домашнего каталога вашего удаленного сервера JupyterHub, а не из текущего каталога вашей локальной системы.

    Если вы добавите новый файл рядом с Jupyter notebook локально, он не будет автоматически доступен для чтения в Jupyter notebook в VS Code.

    </warn>

    <warn>

    Локальная установка пакетов `pip` или `conda` не даст никакого эффекта, так как ваш ​​​​Python kernel работает на вашем удаленном сервере JupyterHub в облаке. Нужные пакеты можно установить в окружении в JupyteHub в облаке, используя `pip` или `conda`.

    </warn>

<info>

Дополнительная информация по подключению к серверу JupyterHub в [официальной документации VS Code](https://code.visualstudio.com/docs/datascience/jupyter-notebooks#_connect-to-a-remote-jupyter-server).

</info>

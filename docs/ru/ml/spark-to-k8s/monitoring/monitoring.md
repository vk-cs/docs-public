Вы можете отслеживать состояние кластера Spark и анализировать его работу, используя следующие инструменты и сервисы:

- Cloud Logging;
- Cloud Monitoring;
- Cloud Alerting;
- журнал событий кластера;
- Spark History Server;
- методы библиотеки Cloud ML Platform.

## Использование Cloud Logging

Сервис [Cloud Logging](/ru/monitoring-services/logging) выполняет сбор, хранение и отображение логов пользовательских приложений и сервисов VK Cloud.

Чтобы иметь возможность просматривать логи кластера:

1. [Установите плагин логирования](/ru/monitoring-services/logging/service-management/connect-plugin) на ВМ кластера.
1. Подождите несколько минут, чтобы накопились данные.
1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где находится нужный кластер.
1. Перейдите в раздел **Мониторинг** → **Логирование**.
1. [Настройте](ru/monitoring-services/logging/service-management/view-logs) фильтрацию логов в таблице.

## Использование Cloud Monitoring

Сервис [Cloud Monitoring](/ru/monitoring-services/monitoring) позволяет отслеживать и анализировать состояние кластера в режиме реального времени по заданным метрикам. Сервис отображает данные сбора метрик на графиках, которые можно настроить так, чтобы получать только нужную информацию о работе кластера.

Чтобы добавить график мониторинга кластера, воспользуйтесь [инструкцией](/ru/monitoring-services/monitoring/quick-start#1_sozdayte_grafik). В поле **Тип ресурса** выберите вариант **Сервис Spark в k8s**.

## Использование Cloud Alerting

Сервис [Cloud Alerting](/ru/monitoring-services/alerting) позволяет настроить информирование об изменении ключевых метрик сервисов VK Cloud.

Чтобы получать уведомления о работе кластера:

1. [Создайте](/ru/monitoring-services/alerting/notification/notification-add) канал уведомлений.
1. [Настройте](/ru/monitoring-services/alerting/triggers/triggers-add) правила, при каких условиях будут отправляться уведомления по созданному каналу связи.

## Использование журнала событий

Журнал событий содержит сообщения о критических ошибках в работе кластера.

Чтобы просмотреть журнал событий:

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где находится нужный кластер.
1. Перейдите в раздел **Контейнеры** → **Кластеры Kubernetes**.
1. Нажмите на имя нужного кластера.
1. Перейдите на вкладку **Журнал событий**.

Если в работе кластера были ошибки, они будут отображаться на вкладке.

## Использование Spark History Server

Сервис Spark History Server собирает информацию об истории выполнения заданий и позволяет просматривать логи приложений в веб-интерфейсе. Сервис подключается для каждого кластера Spark.

Чтобы посмотреть логи в Spark History Server:

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Выберите проект, где находится нужный кластер.
1. Перейдите в раздел **ML Platform → Spark в k8s**.
1. Нажмите на имя нужного кластера.
1. На вкладке **Общие данные** перейдите по ссылке в строке **Spark History Server**.
1. Будет открыт инстанс Spark History Server. Для авторизации введите учетные данные:

    - логин и пароль от личного кабинета VK CLoud — этот способ используется для старых кластеров;
    - [токен доступа](/ru/ml/spark-to-k8s/ml-platform-library/authz) — этот способ используется для новых кластеров.

Отобразится список событий кластера.

## Использование библиотеки Cloud ML Platform

Библиотека [Cloud ML Platform](ru/ml/spark-to-k8s/ml-platform-library/library-reference) позволяет получить списки событий и логов кластера.

Используйте следующие методы:

- `spark_events` — получить список событий, произошедших в кластере.
- `spark_job_logs` — отобразить логи нужного приложения.

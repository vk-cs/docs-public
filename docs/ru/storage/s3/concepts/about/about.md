Cloud Storage — это [объектное хранилище данных](/ru/computing/iaas/concepts/data-storage/storage-types) на платформе VK Cloud, основанное на протоколе S3. Оно подходит для хранения данных большого объема, к которым нечасто обращаются. Работать с Cloud Storage можно в личном кабинете VK Cloud, с помощью интерфейса командной строки AWS CLI, а также ряда [других инструментов](#instruments).

Cloud Storage отличает:

- высокая масштабируемость и доступность;
- простота интеграции с приложениями;
- низкая стоимость хранения данных в сравнении с другими [типами хранилищ](/ru/computing/iaas/concepts/data-storage/storage-types) в VK Cloud.

Данные в Cloud Storage хранятся в [бакетах](#bucket) в виде независимых [объектов](#object) и их [метаданных](#metadata).

## {heading(Бакет)[id=bucket]}

*Бакет* — это контейнер для хранения [объектов](#object). В бакет может быть загружено любое количество объектов. Общий объем объектов в бакете также неограничен. Пользователь, создавший бакет, получает полные права доступа к бакету и объектам в нем и может делиться этими правами с другими.

У каждого бакета есть имя, которое используется для доступа к объектам внутри него. Имя должно удовлетворять определенным [требованиям](#bucket_naming). После создания бакета изменить его имя нельзя.

В проекте можно создать несколько бакетов (максимум — 25), но нельзя вложить один бакет в другой. Внутри каждого бакета можно построить иерархию директорий. Для этого к именам объектов нужно добавить [префиксы](#object_key), которые Cloud Storage интерпретирует как имена директорий.

Бакет можно использовать для хостинга статических сайтов, [привязав к нему свой домен](../../instructions/buckets/manage-bucket#bind_domain), а также в [сервисе CDN в качестве источника](../../instructions/buckets/manage-bucket#use_cdn).

В Cloud Storage поддерживаются:

- [автоматическая очистка](../features#automatic_bucket_cleaning) бакета по заранее заданным правилам;
- [настройка уведомлений](../features#bucket_event_notifications) о событиях в бакете;
- [синхронизация](../../instructions/buckets/manage-bucket#sync_local_directory_and_bucket) содержимого бакета и локальной директории;
-  кросс-доменные запросы ресурсов в бакете по технологии [CORS](../../instructions/access-management/cors).

### {heading(Правила именования бакетов)[id=bucket_naming]}

Имя бакета должно:

- содержать от 3 до 63 символов;
- начинаться и заканчиваться буквой или цифрой;
- состоять только из строчных латинских букв, цифр и символов: `.`, `-`.

Имя бакета не должно:

- начинаться с префикса `xn--`;
- заканчиваться суффиксом `-ol-s3` или `s3alias`;
- заканчиваться дефисом `-`;
- содержать две точки подряд: `..`;
- содержать дефис и точку рядом, например: `my-.bucket.com` или `my.-bucket`;
- иметь формат IP-адреса или схожий с ним, например `192.168.5.4`.

<warn>

Имя бакета должно быть уникальным для всех аккаунтов AWS во всех регионах AWS в пределах раздела. Раздел — это группа регионов. В настоящее время у AWS есть три раздела: `aws` (коммерческие регионы), `aws-cn` (китайские регионы) и `aws-us-gov` (регионы Amazon GovCloud (США)).

Имя бакета не может быть использовано другим аккаунтом AWS в том же разделе, пока бакет не будет удален.

</warn>

Имя бакета содержится в URL-адресах находящихся в нем объектов, поэтому не используйте в имени конфиденциальную информацию. Она будет отображаться в ссылке на объект, если вы предоставите публичный доступ к нему.

Если вы создаете бакет для хостинга и хотите использовать адресацию по типу виртуального хоста через HTTPS, не рекомендуется включать точки в имена бакетов. Это связано с тем, что сертификаты безопасности, используемые для виртуального хостинга бакетов, не работают для бакетов с точками в именах. Это ограничение не распространяется на имена бакетов, используемых для статического хостинга вебсайтов, поскольку такой хостинг доступен только через HTTP.

<details>
<summary>Примеры имен бакетов, соответствующих рекомендуемым правилам</summary>

- `docexamplebucket1`
- `log-delivery-march-2020`
- `my-hosted-content`

</details>

<details>
<summary>Примеры недопустимых имен бакетов</summary>

- `doc_example_bucket` (содержит символы подчеркивания)
- `DocExampleBucket` (содержит прописные буквы)
- `doc-example-bucket-` (заканчивается дефисом)

</details>

## {heading(Объект)[id=object]}

*Объект* — это файл, загруженный в хранилище, и его [метаданные](#metadata). Файл может быть любого формата, например: медиафайл, резервная копия, массив данных BigData.

Объекты в Cloud Storage хранятся в [бакетах](#bucket). В зависимости от размера файла используется [стандартная или составная загрузка](../features#object_uploading) объекта в бакет.

При загрузке объекта ему назначаются:

- [ключ объекта](#object_key) — специальный идентификатор, по которому осуществляется доступ к объекту;
- [метаданные](#metadata), описывающие свойства объекта;
- [уровень доступа](../../instructions/objects/manage-object#manage_access);
- [класс хранения](#storage_class).

Наряду с операциями загрузки, скачивания, копирования и удаления объектов в Cloud Storage поддерживаются:

- [изменение уровня доступа](../../instructions/objects/manage-object#manage_access) для объекта;
- предоставление доступа к объекту по [подписанной ссылке](../../instructions/objects/manage-object#access_via_signed_link);
- временная и постоянная [блокировка](../features#object_lock) объекта от удаления или перезаписи.

## {heading(Ключ объекта)[id=object_key]}

*Ключ объекта* — это комбинация имени объекта и префиксов к имени. Префиксы отделяются друг от друга и от имени объекта разделителем `/`. Префиксы необязательны.

Если в ключе указаны префиксы к имени объекта, Cloud Storage будет использовать их как имена директорий в бакете. При выборе имени объекта и префиксов рекомендуется следовать приведенным ниже правилам.

### {heading(Рекомендации по созданию ключа объекта)[id=object_key_rules]}

Ключ объекта состоит из символов Юникод. Длина ключа в кодировке UTF-8 — не более 1024 байт.

В ключе объекта вы можете использовать любой символ Юникод. Однако некоторые символы могут вызвать проблемы с рядом приложений и веб-протоколов. Чтобы избежать проблем, следуйте рекомендациям:  

- В ключе объекта рекомендуется использовать только латинские буквы, цифры и спецсимволы `/`, `!`, `-`, `_`, `.`, `*`, `'`, `(`, `)`. Символ `/` отделяет друг от друга префиксы и имя объекта.
- Ключ объекта не должен:

  - заканчиваться косой чертой `/`;
  - содержать две точки подряд: `..`;
  - состоять только из одной точки: `.`;
  - состоять только из пробела или содержать ведущие или завершающие пробелы.

- В ключе объекта не рекомендуется использовать приведенные ниже символы. Некоторые из них нуждаются в кодировании при их использовании в URL-адресах, а некоторые являются непечатаемыми и могут не обрабатываться вашим браузером. Чтобы обеспечить корректную адресацию объекта с такими символами в ключе, требуется дополнительная обработка ключа объекта в коде.

  Нежелательные символы:

  - спецсимволы `$`, `&`, `@`, `=`, `;`, `:`, `+`, `\`, `%`, `,`, `?`, `#`;
  - символы с ASCII-кодами `00h`–`1Fh` (десятичные коды `0`–`31`);
  - символ `DEL` с ASCII-кодом `7Fh` (десятичный код `127`);
  - пробел, так как в некоторых случаях могут быть потеряны значимые последовательности пробелов, особенно при наличии нескольких пробелов;
  - все невидимые символы Юникод.

<details>
<summary>Примеры ключей объектов, соответствующих рекомендациям</summary>

- `Development/Projects.xls`
- `Finance/statement1.pdf`
- `Finance/taxdocument.pdf`
- `s3-dg.pdf`

На основе префиксов `Development/` и `Finance/` Cloud Storage создаст директории в бакете. Открыв директорию `Development`, вы увидите в ней объект `Projects.xlsx`, в директории `Finance` найдете объекты `statement1.pdf` и `taxdocument.pdf`. Имя `s3-dg.pdf` не имеет префикса, поэтому этот объект будет размещаться на корневом уровне бакета.

</details>

## {heading(Метаданные объекта)[id=metadata]}

У каждого объекта Cloud Storage есть *метаданные*. Это пары ключ/значение, описывающие свойства объекта. Различают метаданные, присваиваемые системой (например: класс хранения, дата создания), и пользовательские метаданные. Некоторые системные метаданные доступны пользователю для управления, в частности класс хранения объекта.

Вы можете установить метаданные объекта во время его загрузки. После загрузки напрямую изменить метаданные объекта нельзя. Единственный способ сделать это — [скопировать](../../instructions/objects/manage-object#copy_object) объект. При копировании нужно указать ключ объекта одновременно в качестве источника и цели и задать для копии новые метаданные. Таким способом вы можете изменить:

- пользовательские метаданные,
- системные метаданные, управляемые пользователем, например класс хранения.

Метаданные, управляемые системой, при этом будут сброшены. Например, будет сброшена дата создания объекта.

## {heading(Инструменты работы с хранилищем)[id=instruments]}

Кроме личного кабинета VK Cloud для работы с объектным хранилищем Cloud Storage доступны следующие инструменты:

- [Интерфейсы командной строки](../../connect/s3-cli): AWS CLI, s3cmd CLI.
- [Файловые менеджеры](../../connect/s3-file-managers): CyberDuck, WinSCP, Диск-О:, s3fs.
- [Наборы инструментов разработчика](../../connect/s3-sdk): SDK для Java, .NET., Javascript, Ruby, Python (Boto), PHP, Go, AWS-инструменты для Powershell, Mobile SDK для iOS и Android.
- [API Cloud Storage](../s3-api).

## {heading(Классы хранения бакета)[id=storage_class]}

Классы хранения бакета отличаются назначением и [стоимостью хранения](https://cloud.vk.com/pricelist) данных. В VK Cloud поддерживается несколько классов хранения:

- `Hotbox` — для хранения и раздачи большого количества файлов для медиасервисов, онлайн-СМИ, сайтов с многопользовательским контентом и мобильных приложений. В API обозначается названием `STANDARD`.
- `Icebox` — для редко используемых данных: логов, медиаконтента, научных, статистических данных, а также рабочих архивов. В API обозначается названием `STANDARD_IA`.
- `BackupBucket` — для [резервных копий инстансов](/ru/storage/backups), созданных как автоматически, так и вручную. Бакеты такого класса нельзя самостоятельно создать или удалить. После удаления резервных копий бакет BackupBucket может остаться пустым. Он необходим объектному хранилищу для дальнейшей работы с планами резервного копирования в проекте. В API обозначается названием `BACKUP`.

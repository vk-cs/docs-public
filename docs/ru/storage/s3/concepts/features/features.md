Сервис VK Object Storage поддерживает следующие возможности для работы с бакетами и объектами на платформе VK Cloud:

<!-- исправить ссылки: на управлениями версиями после выкатки 2341, на управление доступом после выкатки 1865 -->
- [стандартная и составная загрузка](#object_uploading) объектов в бакет;
- настройка [автоматического удаления](../lifecycle) объектов (lifecycle);
- [копирование объектов](#objects_copying);
- [блокировка удаления объектов](../objects-lock) (object lock);
- [уведомления](#bucket_event_notifications) о событиях в бакете;
- набор инструментов для [управления доступом](../s3-acl) к бакетам и объектам;
- [API](#s3_api) для программного управления бакетами и объектами с помощью стандартных HTTP-запросов.

## {heading(Стандартная и составная загрузка объектов)[id=object_uploading]}

В бакет VK Object Storage можно загружать файлы любого типа, например, изображения, резервные копии, видео.

В зависимости от объема файла рекомендованы различные способы загрузки:

- До 1 ГБ — [стандартная загрузка](../../instructions/objects/upload-object#standard_upload) любым удобным способом: через личный кабинет, файловые менеджеры, CLI, SDK или API.
- Свыше 1 ГБ — CLI, SDK или API.
- Свыше 32 ГБ — только [составная загрузка](../../instructions/objects/upload-object#multipart_upload) через CLI, SDK или API.

При составной загрузке данные разделяются на несколько частей и загружаются по отдельности. Если передача какой-либо части не удалась, ее можно передать повторно, не затрагивая другие части. Когда все части загружены, хранилище собирает их вместе в заданном порядке и создает объект.

Преимущества составной загрузки:

- Части большого файла можно загружать параллельно, тем самым сокращая время загрузки.
- Если какая-то часть не была загружена из-за ошибки сети, ее быстрее перезагрузить, чем большой файл.
- Можно приостановить загрузку и продолжить ее позднее.
- Начать загрузку можно до того, как будет известен окончательный размер файла, т.е. можно загружать файл по мере его создания.

{note:info}

Ограничения на размер загружаемых файлов:

- Максимальный размер несоставного объекта или части составного объекта — 32 ГБ.
- Максимальный размер составного объекта — 320 ТБ.
- Количество частей составной загрузки — от 1 до 10000.

{/note}

## {heading(Копирование объектов)[id=objects_copying]}

VK Object Storage позволяет создавать копии хранимых объектов. Копирование выполняется [с помощью CLI, SDK, файлового менеджера](../../instructions/objects/manage-object#copy_object) или [API](/ru/tools-for-using-services/api/api-spec/s3-rest-api/object-api#copy).

С помощью копирования вы можете:

- Создавать дополнительные копии объектов в том же самом или другом бакете.
- Переименовывать объекты.

  Прямое переименование объектов в бакете не поддерживается. Обойти это ограничение можно, создав копию объекта с новым именем и затем удалив исходный объект.

- Изменять метаданные объекта.

  Метаданные объекта устанавливаются при его загрузке в бакет. Единственный способ изменить их после загрузки — создать копию объекта с тем же именем, указав новые метаданные в запросе на копирование. Таким способом можно изменить пользовательские метаданные и некоторые системные метаданные, например [класс хранения](../about#storage_class).

## {heading(Уведомления о событиях в бакете)[id=bucket_event_notifications]}

VK Object Storage позволяет настроить отправку уведомлений о событиях в бакете с помощью вебхуков (webhooks). В каждом вебхуке указывается тип события и URL-адрес, на который приходит сообщение или HTTP/HTTPS-запрос, когда в бакете происходит событие указанного типа. Можно создать вебхуки для следующих типов событий:

- создание объекта;
- копирование объекта;
- удаление объекта;
- завершение составной загрузки.

Использование вебхуков позволяет:

- информировать пользователя о произошедшем в бакете событии;
- настроить обработку и конвертирование файлов после загрузки;
- настроить взаимодействие с внешними системами;
- подключить логирование для объектного хранилища.

Конфигурация вебхуков для бакета создается [через личный кабинет](../../instructions/buckets/manage-bucket#manage_webhooks) или [с помощью API](/ru/tools-for-using-services/api/api-spec/s3-rest-api/webhook-api).

## {heading(Использование API)[id=s3_api]}

VK Object Storage предоставляет RESTful XML [API](/ru/tools-for-using-services/api/api-spec/s3-rest-api) для программного управления бакетами и объектами с помощью стандартных HTTP-запросов. VK Object Storage API предназначен для взаимодействия с [Amazon Web Service S3 API](https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html) и имеет совместимый с ним интерфейс. Для доступа к VK Object Storage API используется протокол, созданный для сервиса AWS S3.

Запросы к API вы можете передавать через [AWS CLI](../../connect/s3-cli), [SDK](../../connect/s3-sdk) или [файловые менеджеры](../../connect/s3-file-managers).

Некоторые методы AWS S3 API в сервисе VK Object Storage не реализованы. Запросы для таких методов возвращают S3-совместимый ответ об ошибке `NotImplemented` в формате XML.

{cut(Реализованные в VK Object Storage методы AWS S3 API)}

### Бакет

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`CreateBucket`
|Создает новый бакет

|`DeleteBucket`
|Удаляет бакет

|`HeadBucket`
|Проверяет, существует ли бакет и есть ли у пользователя права доступа к нему

|`ListBuckets`
|Возвращает список бакетов

|`GetBucketLocation`
|Возвращает [регион](/ru/tools-for-using-services/account/concepts/regions) бакета
|===

### Объект

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`CopyObject`
|Создает копию существующего объекта (в том же или в другом бакете)

|`DeleteObject`
|Удаляет объект из бакета

|`DeleteObjects`
|Удаляет несколько объектов одним запросом

|`GetObject`
|Возвращает содержимое объекта

|`HeadObject`
|Возвращает метаданные объекта

|`ListObjects`
|Возвращает до 1000 объектов. Это устаревший метод, поддерживается для совместимости

|`ListObjectsV2`
|Возвращает до 1000 объектов. Актуальный метод

|`PutObject`
|Добавляет объект в бакет

|`GetObjectRange`
|Возвращает только указанный байтовый диапазон объекта (range-запрос)

|`OptionsObject`
|Обрабатывает предварительный CORS-запрос (метод `OPTIONS`) к объекту. Возвращает заголовки разрешений
|===

### Блокировка объектов (object lock)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetObjectLegalHold`
|Возвращает текущее состояние бессрочной (legal hold) блокировки для объекта

|`GetObjectRetention`
|Возвращает информацию о текущей временной блокировке (retention) объекта

|`PutObjectLegalHold`
|Устанавливает или снимает бессрочную (legal hold) блокировку объекта

|`PutObjectLockConfiguration`
|Создает или изменяет настройки блокировок по умолчанию в бакете

|`PutObjectRetention`
|Устанавливает или обновляет временную блокировку (retention) для объекта
|===

### Управление доступом

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetObjectACL`
|Возвращает ACL (список контроля доступа) объекта

|`PutObjectACL`
|Устанавливает ACL объекта

|`GetBucketAcl`
|Возвращает ACL бакета

|`PutBucketAcl`
|Устанавливает ACL бакета
|===

### Жизненный цикл объектов (lifecycle)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetBucketLifecycleConfiguration`
|Возвращает конфигурацию жизненного цикла бакета

|`PutBucketLifecycleConfiguration`
|Создает или полностью заменяет конфигурацию жизненного цикла бакета

|`DeleteBucketLifecycle`
|Удаляет конфигурацию жизненного цикла бакета
|===

### Составная загрузка (multipart)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`AbortMultipartUpload`
|Прерывает незавершенную составную загрузку и освобождает ресурсы

|`CompleteMultipartUpload`
|Завершает составную загрузку, собирая части в финальный объект

|`CreateMultipartUpload`
|Инициирует составную загрузку объекта

|`ListMultipartUploads`
|Возвращает список текущих незавершенных составных загрузок в бакете

|`ListParts`
|Возвращает список загруженных частей объекта

|`UploadPart`
|Загружает часть объекта

|`UploadPartCopy`
|Загружает часть объекта, скопировав данные из существующего объекта
|===

### Политики владения объектами (ownership controls)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`PutBucketOwnershipControls`
|Устанавливает или обновляет правила, определяющие владельца загружаемых в бакет объектов

|`DeleteBucketOwnershipControls`
|Удаляет политики по управлению владельцем объектов в бакете
|===

### Маркировка объектов тегами (tagging)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetObjectTagging`
|Возвращает теги, назначенные объекту

|`PutObjectTagging`
|Присваивает или обновляет теги объекта

|`DeleteObjectTagging`
|Удаляет теги объекта
|===

### Кросс-доменные запросы (CORS)

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetBucketCors`
|Возвращает текущую конфигурацию CORS бакета

|`PutBucketCors`
|Устанавливает или заменяет конфигурацию CORS бакета

|`DeleteBucketCors`
|Удаляет конфигурацию CORS бакета
|===

### Уведомления

[cols="1,2",options="header"]
|===
|Метод
|Описание

|`GetBucketNotificationConfiguration`
|Возвращает текущую конфигурацию уведомлений для бакета

|`PutBucketNotificationConfiguration`
|Устанавливает или обновляет конфигурацию уведомлений

|`DeleteBucketNotificationConfiguration`
|Удаляет конфигурацию уведомлений у бакета
|===

{/cut}


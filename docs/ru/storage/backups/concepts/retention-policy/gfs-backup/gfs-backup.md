В VK Cloud для хранения и удаления резервных копий может быть использована GFS-стратегия («дед-отец-сын», Grandfather-Father-Son).

В GFS-стратегии резервное копирование включает три уровня иерархии:

- «Дед» — полная резервная копия на начало года.
- «Отец» — полная резервная копия на начало месяца.
- «Сын» — полная резервная копия раз в неделю и инкрементальные копии за неделю.

Срок хранения резервных копий задается отдельно для каждого уровня. Как правило, сроки выбираются так, чтобы удовлетворять требованиям законодательства или корпоративным политикам.

Чаще всего применяются следующие настройки:

- Хранить недельные резервные копии: 4 недели.
- Хранить месячные резервные копии: 12 месяцев.
- Хранить годовые резервные копии: 5 лет.

<info>

Срок хранения годовых резервных копий включает текущий год. Если, например, установить срок хранения в 2 года, будут сохраняться годовые резервные копии за прошлый и текущий годы.

</info>

## Принцип работы

Создание резервных копий запускается автоматически согласно заранее настроенному расписанию. После каждого успешного резервного копирования запускается процесс удаления устаревших копий:

1. Проверяются сроки хранения недельных резервных копий.
1. Проверяется наличие месячных и годовых резервных копий и сроки их хранения.
1. Алгоритм определяет, какие копии являются устаревшими в соответствии с настройками GFS-стратегии, и удаляет их.

Если вы измените настройки GFS, изменения применятся при следующем успешном резервном копировании. Если срок хранения каких-либо полных копий в настройках был уменьшен, устаревшие копии будут удалены.

В результате процессов создания и удаления формируется следующий иерархический набор хранимых резервных копий:

- Недельные резервные копии — полные и инкрементальные резервные копии за выбранное в настройках количество недель.
- Месячные резервные копии — полные резервные копии, созданные на начало месяца, за выбранное в настройках количество календарных месяцев. Инкрементальные резервные копии удаляются.
- Годовые резервные копии — полные резервные копии, созданные на начало года, за выбранное в настройках количество лет (включая текущий календарный год). Инкрементальные резервные копии удаляются.

<info>

Одна и та же резервная копия не может быть одновременно месячной и недельной (или годовой и месячной). Каждая резервная копия помечается одним из тегов: «недельная», «месячная» или «годовая».

</info>

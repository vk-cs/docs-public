<warn>

Изменение созданных виртуальных ресурсов (ВМ, балансировщиков, инстансов БД) вне сервиса может привести к неработоспособности отдельных рабочих столов или всего пула в целом.

</warn>

## {heading(Подготовительные шаги)[id=preparatory_steps]}

1. Убедитесь, что [подключение к сервису](../../config) настроено.
1. (Опционально) Если хотите использовать для создания ВМ пула собственный образ, [подготовьте](/ru/computing/cloud-desktops/concepts/desktop-image) и [проверьте](/ru/computing/cloud-desktops/how-to-guides/check-desktop-image) его.
1. (Опционально) Если ранее при [настройке сети](../../config/setup-net#setup_net) для инфраструктуры сервиса вы выбрали [ручной режим](../../../concepts/about#manual_net_setup), подготовьте сеть для пула рабочих столов:

    1. [Перейдите](https://msk.cloud.vk.com/app) в личный кабинет VK Cloud.
    1. Перейдите в раздел **Виртуальные сети** → **Сети**.
    1. Нажмите на имя нужной сети. Если сети еще нет, [создайте](/ru/networks/vnet/service-management/net#sozdanie_seti) ее.
    1. Нажмите ![ ](/ru/assets/more-icon.svg "inline") для нужной подсети и выберите пункт **Редактировать подсеть**. Если нужной подсети еще нет, [создайте](/ru/networks/vnet/service-management/net#sozdanie_podseti) ее с учетом [требований к количеству портов](../../../concepts/about#ports_number).
    1. Отключите опцию **Приватный DNS**.
    1. В поле **DNS-серверы** на первых позициях в списке укажите IP-адреса ваших DNS-серверов, каждый адрес с новой строки.
    1. Сохраните изменения.
    1. Нажмите на имя подсети и перейдите на вкладку **Порты**.
    1. Убедитесь, что количество свободных портов в подсети соответствует [требованиям](../../../concepts/about#ports_number). Если их недостаточно, используйте другую подсеть.

## {heading(1. Запустите мастер создания пула)[id=launch_master]}

1. [Перейдите](https://msk.cloud.vk.com/app) в личный кабинет VK Cloud.
1. Перейдите в раздел **Cloud Desktop** → **Пулы рабочих столов**.
1. Нажмите кнопку **Добавить**.

   Откроется мастер создания нового пула.

## {heading(2. Настройте конфигурацию пула)[id=setup_pool_configuration]}

1. Задайте конфигурацию пула:

    - **Имя пула**: задайте имя, уникальное внутри проекта. Требования к полю: от 3 до 128 символов, допустимы только латинские буквы, символы `-`, `_`, пробелы и цифры.
    - **Тип пула**: выберите один из вариантов:

        - **Сессионный** — в таком пуле пользователю при подключении рабочий стол назначается автоматически. Используйте сессионный пул, если нужно развернуть большое количество столов одинаковой конфигурации с одним и тем же набором ПО. В сессионном пуле предусмотрен горячий резерв столов.
        - **Персонализированный** — в таком пуле каждый рабочий стол закрепляется за пользователем, который первым к нему подключился. Пользователь владеет этим рабочим столом до окончания его жизненного цикла и может настраивать его под решение своих задач. Этот тип пула используется чаще всего.

    - **Описание**: описание пула, до 250 символов.
    - **Сеть**: выберите из списка ранее [подготовленную сеть](#preparatory_steps). Параметр доступен, если в [сетевых настройках](../../config/setup-net#setup_net) сервиса выбран ручной режим.
    - **Группа пользователей**: укажите группу пользователей каталога AD или LDAP. Для пользователей этой группы будут назначаться рабочие столы из пула. Требования к полю: от 3 до 100 символов, допустимы только латинские буквы, символы `-`, `_`, `.` и цифры.
    - **OU**: укажите организационное подразделение (organizational unit) в каталоге AD или LDAP. Например, `OU=Workstations,DC=domain,DC=com`.
    - **Маска именования**: суффикс, с которого будут начинаться имена рабочих столов в этом пуле. Требования к маске: от 3 до 15 символов, допустимы только латинские буквы в нижнем регистре и символ `-` на конце.
    - **Мин. кол-во рабочих столов** — определяет, сколько рабочих столов будет развернуто сразу после создания пула. По умолчанию — `0`.

      Этот параметр не может превышать значение параметра **Макс. кол-во рабочих столов**.

    - **Макс. кол-во рабочих столов** — определяет, сколько столов в пуле могут одновременно использоваться.
    - **Горячий резерв** — доступен только для сессионных пулов. Столы из горячего резерва становятся доступными только в момент подключения пользователя и при завершении пользовательской сессии возвращаются в резерв.

      В горячем резерве не будет доступных рабочих столов, если выбрано значение `0` или параметры **Мин. кол-во рабочих столов** и **Макс. кол-во рабочих столов** совпадают.

    - **Таймаут неактивности польз.**: время, через которое пользователь будет отсоединен от рабочего стола при отсутствии активности в рабочем столе. Таймаут работает для протоколов RDP и RX.

      При значении `0` пользовательская сессия не будет прерываться по тайм-ауту.

1. Нажмите кнопку **Следующий шаг**.

## {heading(3. Настройте виртуальные машины пула)[id=configure_pool_vms]}

1. Задайте настройки виртуальных машин, на которых будут создаваться рабочие столы пула:

    - **Категория виртуальной машины**: выберите [категорию](/ru/computing/iaas/concepts/about#vm_categories) из списка. Категория является фильтром для поля **Тип инстанса**.
    - **Тип инстанса**: выберите тип ВМ из списка типов, доступных в проекте.
    - **Размер диска**: укажите размер диска в ГБ. Значение не может быть меньше размера образа ОС.
    - **Тип диска**: выберите одно из значений — `HDD`, `SSD` или `High-IOPS SSD`.
    - **Образ**: выберите образ для создания ВМ из списка доступных образов. При необходимости нажмите кнопку **Загрузить свой образ** и загрузите ранее [подготовленный](/ru/computing/cloud-desktops/concepts/desktop-image) и [проверенный](/ru/computing/cloud-desktops/how-to-guides/check-desktop-image) образ, следуя [инструкции по импорту](/ru/computing/iaas/service-management/images/images-manage#import_obraza).

      <info>

      Создать пул невозможно до завершения загрузки образа.

      </info>

    - **Зона доступности**: выберите [зону доступности](/ru/intro/start/concepts/architecture#az) виртуальных машин пула из списка.

1. (Опционально) Нажмите кнопку **Добавить группу безопасности** и укажите дополнительные группы безопасности для ВМ. Основная группа безопасности с именем `vdi-desktop-<ИМЯ_ПУЛА>` назначается пулу автоматически.
1. Нажмите кнопку **Следующий шаг**.

## {heading(4. Настройте периферию)[id=configure_peripherals]}

1. Выберите, какие [периферийные устройства](../../../concepts/about#dostupnye_periferiynye_ustroystva) будут доступны пользователям рабочих столов пула.
1. Нажмите кнопку **Создать пул**.

   Начнется создание пула. Это может занять до 40 минут.

При успешном создании пула откроется список созданных пулов.

<warn>

Если для создания виртуальных машин пула выбран образ с ОС Windows, [настройте](../../group-policies) групповые политики для вашего контроллера домена Active Directory, чтобы конечные пользователи могли подключаться к виртуальным рабочим столам.

</warn>

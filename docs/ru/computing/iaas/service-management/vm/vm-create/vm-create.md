В Cloud Servers можно создавать виртуальные машины через личный кабинет, OpenStack CLI или Terraform. Для создания виртуальной машины с помощью Terraform воспользуйтесь [инструкцией по созданию ВМ](/ru/tools-for-using-services/terraform/how-to-guides/iaas/create) в разделе Terraform.

## Перед началом работы

1. [Зарегистрируйтесь](/ru/intro/start/account-registration) на платформе VK Cloud.
1. Убедитесь, что баланс счета положительный, а [квот](/ru/tools-for-using-services/account/concepts/quotasandlimits) достаточно для создания желаемой конфигурации виртуальной машины.

### Доступные ОС

Командой VK Cloud подготовлены образы некоторых ОС. Список готовых образов доступен в личном кабинете в [окне создания новой виртуальной машины](https://msk.cloud.vk.com/app/services/infra/servers/add).

При необходимости вы можете [импортировать образ](../../images/images-manage#import_obraza) ОС самостоятельно.

## {heading(Создайте ВМ)[id=create_vm]}

<info>

Доступные для настройки параметры ВМ могут отличаться для разных операционных систем.

</info>

<tabs>
<tablist>
<tab>Личный кабинет</tab>
<tab>OpenStack CLI</tab>
</tablist>
<tabpanel>

1. [Перейдите](https://msk.cloud.vk.com/app/) в личный кабинет VK Cloud.
1. Проверьте, что баланс счета положителен и [квот](/ru/tools-for-using-services/account/concepts/quotasandlimits) достаточно для создания желаемой конфигурации виртуальной машины.
1. Перейдите в раздел **Облачные вычисления → Виртуальные машины**.
1. Нажмите кнопку **Создать инстанс** или **Добавить**.
1. Задайте параметры ВМ:
     - **Имя виртуальной машины**: используйте только латинские буквы, цифры или спецсимволы `-`, `_` и `.`.
     - **Категория виртуальной машины**: выберите категорию предустановленных конфигураций ВМ. Подробнее в [обзоре сервиса Cloud Servers](../../../concepts/about#flavors).
     - **Тип виртуальной машины**: выберите предустановленную конфигурацию ВМ. Подробнее в [обзоре сервиса Cloud Servers](../../../concepts/about#flavors).
     - **Зона доступности**: выберите дата-центр, где будет запущена ВМ.
     - **Количество машин в конфигурации**: укажите нужное число ВМ.
     - **Размер диска**: укажите нужный размер диска ВМ в гигабайтах.
     - **Тип диска**: выберите одно из значений — HDD, SSD или High-IOPS SSD. Подробнее в [обзоре сервиса Cloud Servers](../../../concepts/about#diski).
     - **Операционная система**: выберите версию операционной системы или образ, который вы ранее [создали](../../images/images-manage#sozdanie_obraza) или [импортировали](../../images/images-manage#import_obraza) в VK Cloud.
     - **Теги**: при необходимости [укажите тег](../vm-manage#prisvoenie_tegov) для ВМ или создайте новый.
1. Нажмите кнопку **Следующий шаг**.
1. Настройте подключение ВМ к сети:
   - **Сеть**: выберите существующую сеть или создайте новую. В зависимости от выбора типа сети, список доступных полей изменится.
   - **SDN**: выберите [систему управления виртуальными сетями](/ru/networks/vnet/concepts/sdn). Ресурсы, созданные в сетях разных SDN, будут доступны друг другу только при использовании плавающих IP. Опция доступна, если для ВМ создается новая сеть.
   - **Адрес подсети**: опция доступна, если для ВМ создается новая сеть.
   - **Использовать конфигурационный диск**: включите опцию, если нужно настроить сеть на виртуальной машине при отсутствии в сети DHCP-сервера. Опция включается автоматически, если выбрана сеть с выключенным [DHCP](/ru/networks/vnet/concepts/ips-and-inet#setevaya_adresaciya), в том числе внешняя сеть (`ext-net`).
   - **DNS-имя**: укажите DNS-имя для виртуальной машины. Подробнее в разделе [Приватный DNS](/ru/networks/dns/private-dns). Опция недоступна, если выбрана внешняя сеть (`ext-net`).
   - **Ключ виртуальной машины**: выберите ключ для подключения по SSH или создайте новый.

      При выборе `Создать новый ключ` сохраните предложенный файл ключа `.pem` после завершения создания виртуальной машины.

   - **Настройки Firewall**: выберите нужные группы безопасности.

      Чтобы подключиться по SSH, добавьте группу `ssh` или `ssh+www`. Подробнее про настройку правил сетевого доступа в разделе [Управление правилами файервола](/ru/networks/vnet/service-management/secgroups).

   - (Опционально) **Назначить внешний IP**: включите опцию и укажите IP-адрес для возможности подключаться к ВМ из интернета. Опция доступна, если ВМ находится в сети с подключением к интернету. Опция включается и назначает IP-адрес автоматически, если ВМ расположена во внешней сети (ext-net).

   - (Опционально) **Привязать домен к внешнему IP**: включите опцию и укажите домен для привязки FQDN к внешнему IP-адресу. В DNS-зону будет добавлена [A-запись](/ru/networks/dns/publicdns#dobavlenie_resursnyh_zapisey) для выбранного IP-адреса. Опция доступна, если включена опция **Назначить внешний IP**.

      <warn>

      Нельзя привязать внешний IP-адрес к домену, совпадающему с CNAME-записью DNS-зоны. ВМ в этом случае будет создана, но A-запись не будет добавлена.

      </warn>

   - **Включить мониторинг**: включите, чтобы использовать [инструменты мониторинга](/ru/monitoring-services/monitoring/concepts).

1. Нажмите кнопку **Следующий шаг**.

1. Если необходимо, включите опцию **Использовать резервное копирование** и [задайте](/ru/storage/backups/service-management/create-backup-plan#create_vm_backup_plan) нужные настройки.
1. Нажмите кнопку **Создать инстанс**.
1. Дождитесь создания ВМ. Этот процесс может занять некоторое время. Когда создание будет завершено, откроется страница с характеристиками ВМ и инструкцией по подключению.

</tabpanel>
<tabpanel>

1. Подготовьтесь к работе с OpenStack CLI:

   1. [Включите](/ru/tools-for-using-services/vk-cloud-account/service-management/account-manage/manage-2fa) двухфакторную аутентификацию.
   2. [Активируйте](/ru/tools-for-using-services/api/rest-api/enable-api) доступ по API для текущего пользователя.
   3. Убедитесь, что клиент OpenStack [установлен](/ru/tools-for-using-services/cli/openstack-cli#1_ustanovite_klient_openstack), и [пройдите аутентификацию](/ru/tools-for-using-services/cli/openstack-cli#3_proydite_autentifikaciyu) в проекте.

2. Соберите данные:

   1. Получите список доступных типов ВМ и сохраните нужный `flavor_ID`:

      ```bash
      openstack flavor list
      ```

   2. Получите список доступных образов ВМ и сохраните нужный `image_ID`:

      ```bash
      openstack image list
      ```

   3. Получите список групп безопасности:

      ```bash
      openstack security group list
      ```

       - Для создания ВМ Linux и подключения к ней по SSH сохраните `security_group_ID` группы `ssh` или `ssh+www`.
       - Для создания ВМ Windows и подключения к ней по RDP сохраните `security_group_ID` группы `rdp` или `rdp+www`.

      Подробнее про настройку правил сетевого доступа в разделе [Управление правилами файервола](/ru/networks/vnet/service-management/secgroups).

   4. Получите список доступных сетей и сохраните нужный `network_ID`:

      ```bash
      openstack network list
      ```

      - Если выбрана сеть `ext-net`, то виртуальной машине будет автоматически назначен внешний IP-адрес.
      - Если выбрана приватная сеть, то виртуальной машине после создания можно [назначить плавающий IP-адрес](/ru/networks/vnet/service-management/floating-ip).

   5. Получите список доступных ключевых пар и сохраните `keypair_name`:

      ```bash
      openstack keypair list
      ```

      Чтобы создать новую ключевую пару:
         1. Сгенерируйте ключ:

            ```bash
            ssh-keygen -q -N ""
            ```

         2. Загрузите ключ:

            ```bash
            openstack keypair create --public-key ~/.ssh/id_rsa.pub --type ssh <keypair_name>
            ```

3. Создайте загрузочный диск:

   ```bash
   openstack volume create root-volume --size 10 --image <image_id> --availability-zone MS1 --bootable
   ```

4. Создайте ВМ:

   ```bash
   openstack server create <VM_name>
                           --volume <volume_id>
                           --network <network_ID> \
                           --flavor <flavor_ID> \
                           --key-name <keypair_name> \
                           --availability-zone MS1
   ```

   <warn>

   Если в опции `--network` указана внешняя сеть (`ext-net`), добавьте опцию `--use-config-drive` в команду создания ВМ.

   </warn>

   После создания виртуальной машины отобразится информация о ней. Найдите поле `adminPass` и скопируйте его значение. Оно понадобится для входа на сервер через консоль VNC.

5. Проверьте состояние созданной ВМ:

   ```bash
   openstack server list
   ```

   Созданная машина должна появиться в списке доступных ВМ и иметь статус `ACTIVE`.

<info>

Некоторые особенности создания ВМ через CLI:

- Если не указать зону доступности, будет выбрана случайная.
- Если не указать диск, будет создан «эфемерный диск» (с ограничениями).

</info>

</tabpanel>
</tabs>

## Что дальше?

- Посмотрите способы подключения к [ВМ Linux](../vm-connect/vm-connect-nix) или [ВМ Windows](../vm-connect/vm-connect-win).
- Узнайте, как [работать с ВМ](../vm-manage).

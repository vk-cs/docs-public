Рекомендуемый способ подключения к виртуальной машине Linux – по протоколу SSH с использованием ключевой пары.

## 1. Проверьте возможность подключения по SSH

Для подключения по SSH необходимо, чтобы на виртуальной машине был запущен сервер SSH. На виртуальных машинах Linux, созданных в VK Cloud, по умолчанию устанавливается и запускается OpenSSH-сервер.

Перед подключением убедитесь, что выполняются следующие условия:

- виртуальная машина запущена и процесс загрузки ОС завершился;
- в настройках сети ВМ разрешен удаленный доступ по протоколу SSH (TCP-порт `22`) — [добавьте](/ru/networks/vnet/service-management/secgroups#naznachenie_gruppy_pravil_na_instans) группу безопасности `ssh`;
- у ВМ есть внешний («плавающий») IP-адрес, доступный для подключения.

   <info>

   Внешний IP-адрес ВМ можно посмотреть в [личном кабинете](https://msk.cloud.vk.com/app/) VK Cloud в разделе **Облачные вычисления → Виртуальные машины**.

   </info>

Вместо внешнего IP-адреса можно использовать полное доменное имя виртуальной машины (FQDN). Для подключения по полному доменному имени требуются правильно настроенные DNS-записи.

<info>

VK Cloud предоставляет [DNS-серверы](/networks/dns/publicdns), на которые вы можете делегировать свой домен.

</info>

В виртуальных машинах, которые были созданы из предлагаемых платформой VK Cloud образов FreeBSD и Bitrix, не поддерживается работа с внешней сетью `ext-net`. Для подключения по SSH к такой ВМ необходимо, чтобы она находилась в приватной сети со включенным DHCP.

Если подключение к виртуальной машине по SSH невозможно или недоступно, используйте [VNC-консоль](../../vm-console#vnc_konsol).

## 2. Выберите имя пользователя

Определите имя пользователя (логин) операционной системы, которая развернута на целевой ВМ.

В образах VK Cloud (кроме Bitrix) учетная запись `root` заблокирована в целях безопасности и добавлена учетная запись для использования по умолчанию:

| Операционная система | Имя пользователя |
| ---                  | ---              |
| AlmaLinux            | almalinux        |
| ALT Linux            | altlinux         |
| Astra Linux          | astra            |
| Bitrix               | root             |
| CentOS               | centos           |
| Debian               | debian           |
| Fedora               | fedora           |
| FreeBSD              | freebsd          |
| openSUSE             | opensuse         |
| Ubuntu               | ubuntu           |
| РЕД ОС               | redos            |

## 3. Проверьте наличие ключевой пары

Для подключения к ВМ по SSH с использованием ключевой пары необходимо, чтобы публичный ключ был сохранен на виртуальной машине в файле `~/.ssh/authorized_keys`, а файл с приватным ключом находился на компьютере, с которого выполняется подключение.

Если виртуальная машина создавалась на платформе VK Cloud:

- публичный ключ был сохранен на виртуальной машине автоматически;
- при выборе опции **Создать новый ключ** приватный ключ в файле с расширением `.pem` был загружен на компьютер, с которого создавалась ВМ.

В случае если один или оба ключа из пары утрачены, следуйте [инструкции по восстановлению](../../vm-manage#vosstanovlenie_dostupa_k_vm_po_klyuchu).

## 4. Подключитесь к ВМ

<tabs>
<tablist>
<tab>Linux/macOS</tab>
<tab>Windows 10/11</tab>
<tab>Windows 7/8</tab>
</tablist>
<tabpanel>

1. (Опционально) Настройте права доступа к файлу ключа:

   ```bash
   chmod 400 <путь к ключу>
   ```

2. Выполните команду в терминале.

   - Для подключения по IP-адресу:

      ```bash
      ssh -i <путь к ключу> <имя пользователя>@<внешний IP-адрес виртуальной машины>
      ```

   - Для подключения по полному доменному имени:

     ```bash
      ssh -i <путь к ключу> <имя пользователя>@<полное доменное имя виртуальной машины>
      ```

3. Если это первое подключение к ВМ, появится запрос подтверждения:

      ```bash
      The authenticity of host '213.219.212.130 (213.219.212.130)' can't be established.
      ECDSA key fingerprint is SHA256:aYZIWs9N6KRtfFOuic6eoWcluhSp6+jha/DSBgd9McI.
      Are you sure you want to continue connecting (yes/no)?
      ```

      Введите в терминале `yes` и нажмите _Enter_.

      <info>

      При первом подключении к виртуальной машине, созданной из образа Bitrix VK Cloud, в консоли появится запрос на изменение пароля для пользователя `root`. Укажите текущий пароль `bitrix` и дважды введите новый пароль.

      </info>

</tabpanel>
<tabpanel>

1. (Опционально) Настройте права доступа к файлу приватного ключа:

   1. Откройте свойства файла приватного ключа `.pem`.
   2. Перейдите на вкладку **Безопасность** и нажмите кнопку **Дополнительно**. Откроется окно **Дополнительные параметры безопасности**.
   3. Нажмите кнопку **Отключение наследования** и в открывшемся окне выберите **Удалить все унаследованные разрешения из этого объекта**.
   4. В окне **Дополнительные параметры безопасности** нажмите кнопку **Добавить**.
   5. В открывшемся окне нажмите **Выберите субъект** и укажите пользователя ОС Windows, от имени которого будет запущена командная строка для подключения к ВМ.
   6. Подтвердите изменения, последовательно нажав **ОК** в открытых окнах настроек.

2. Выполните команду в командной строке.

   - Для подключения по IP-адресу:

      ```bash
      ssh -i <путь к ключу> <имя пользователя>@<внешний IP-адрес виртуальной машины>
      ```

   - Для подключения по полному доменному имени:

     ```bash
      ssh -i <путь к ключу> <имя пользователя>@<полное доменное имя виртуальной машины>
      ```

3. Если это первое подключение к ВМ, появится запрос подтверждения:

      ```shell
      The authenticity of host '213.219.212.130 (213.219.212.130)' can't be established.
      ECDSA key fingerprint is SHA256:aYZIWs9N6KRtfFOuic6eoWcluhSp6+jha/DSBgd9McI.
      Are you sure you want to continue connecting (yes/no)?
      ```

     Введите в командной строке `yes` и нажмите _Enter_.

      <info>

      При первом подключении к виртуальной машине, созданной из образа Bitrix VK Cloud, в консоли появится запрос на изменение пароля для пользователя `root`. Укажите текущий пароль `bitrix` и дважды введите новый пароль.

      </info>

</tabpanel>
<tabpanel>

В Windows 7/8 для подключения по SSH используйте приложение PuTTY.

1. [Установите](https://www.putty.org/) PuTTY.
2. Создайте файл приватного ключа в формате PuTTY Private Key Files:

   1. Запустите приложение PuTTYgen, которое идет в комплекте c PuTTY.
   2. В меню **Conversions** нажмите **Import Key** и в открывшемся окне выберите файл приватного ключа `.pem`.
   3. Нажмите кнопку **Save private key**.
   4. В открывшемся окне выберите директорию, введите имя файла, проверьте, что в поле **Тип файла** указано расширение `.ppk`, и нажмите **Сохранить**.

3. Добавьте файл приватного ключа `.ppk` в Pageant:

   1. Запустите приложение Pageant, которое идет в комплекте c PuTTY.
   2. Нажмите правой кнопкой мыши на значок Pageant на панели задач.
   3. В контекстном меню выберите пункт **Add key**.
   4. Выберите созданный на предыдущем шаге файл приватного ключа `.ppk`.

4. Запустите PuTTY:

   1. В поле **Host Name (or IP address)** введите внешний IP-адрес виртуальной машины или ее полное доменное имя. Укажите порт `22` и тип соединения `SSH`.
   2. Откройте в дереве слева пункт **Connection → SSH → Auth**.
   3. Установите флаг **Allow agent forwarding**.
   4. В поле **Private key file for authentication** выберите файл приватного ключа `.ppk`.
   5. Нажмите кнопку **Open**.
   6. Если это первое подключение к ВМ, подтвердите его в появившемся окне.
   7. В открывшемся окне терминала появится приглашение ввести имя пользователя ОС.
   8. Введите имя пользователя операционной системы ВМ. В результате должно быть установлено соединение с сервером.

      <info>

      При первом подключении к виртуальной машине, созданной из образа Bitrix VK Cloud, в консоли появится запрос на изменение пароля для пользователя `root`. Укажите текущий пароль `bitrix` и дважды введите новый пароль.

      </info>

</tabpanel>
</tabs>

<warn>

Если не удалось подключиться к ВМ по SSH, воспользуйтесь инструкцией из статьи [Сеть в ВМ Linux](../../../../troubleshooting/linux-vm-network/).

</warn>

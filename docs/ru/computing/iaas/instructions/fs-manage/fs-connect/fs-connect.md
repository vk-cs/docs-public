Подключение и отключение файловых хранилищ, запись и чтение данных доступны только на виртуальных машинах VK Cloud.

## {heading(Подключение файлового хранилища)[id=mount_file_storage]}

Способ подключения файлового хранилища зависит от операционной системы виртуальной машины, [Windows](#mount_fs_windows) или [Linux](#mount_fs_linux), и протокола, выбранного при создании хранилища.

### {heading(Windows)[id=mount_fs_windows]}

{tabs}

{tab(Протокол NFS)}

Подключить файловое хранилище по протоколу NFS в Windows можно с помощью компонента Windows Server — Клиент для NFS.

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-win) к виртуальной машине VK Cloud.

1. Установите Клиент для NFS из интерфейса Диспетчера серверов или с помощью PowerShell:

    {tabs}
    
    {tab(Диспетчер серверов)}
        
    1. Откройте Диспетчер серверов и в меню **Управление** выберите **Добавить роли и компоненты**.
    1. Перейдите в раздел **Тип установки**, выберите опцию **Установка ролей и компонентов** и нажмите **Далее**.
    1. Перейдите в раздел **Компоненты**, выберите в списке **Клиент для NFS**.
    1. В том же списке раскройте опции **Средства удаленного администрирования серверов → Средства администрирования ролей → Средства файловых служб** и выберите **Службы для средств управления NFS**. Нажмите **Далее**.
    1. Проверьте, что выбраны все необходимые компоненты, и нажмите **Установить**.
    1. Дождитесь окончания установки и перезагрузите сервер.

    {/tab}
    
    {tab(PowerShell)}
    
    1. Установите Клиент для NFS и службы для средств управления NFS:

       ```console
       Install-WindowsFeature NFS-Client, RSAT-NFS-Admin
       ```

    2. Дождитесь окончания установки и перезагрузите сервер.

    {/tab}

    {/tabs}

2. Измените настройки клиента с помощью Диспетчера серверов:

   1. В меню **Средства** выберите **Службы для NFS**.
   1. Выберите **Клиент для NFS** и нажмите на значок **Отобразить окно свойств**.
   1. Задайте нужные настройки.

3. Подключите файловое хранилище:

    ```console
    mount <ТОЧКА_ПОДКЛЮЧЕНИЯ> <БУКВА_ДИСКА>:
    ```

    Здесь:

    - `<ТОЧКА_ПОДКЛЮЧЕНИЯ>` — адрес файлового хранилища. Чтобы узнать его, [посмотрите](../fs-operations#prosmotr_informacii_o_faylovom_hranilishche) информацию о файловом хранилище.
    - `<БУКВА_ДИСКА>` — заглавная латинская буква, которая не используется другими дисками.

{/tab}

{tab(Протокол CIFS)}

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-win) к виртуальной машине VK Cloud.

1. Подключите файловое хранилище:

   ```console
   net use <БУКВА_ДИСКА>: <ТОЧКА_ПОДКЛЮЧЕНИЯ>
   ```
   
   Здесь:
   
   - `<ТОЧКА_ПОДКЛЮЧЕНИЯ>` — адрес файлового хранилища. Чтобы узнать его, [посмотрите](../fs-operations#prosmotr_informacii_o_faylovom_hranilishche) информацию о файловом хранилище.
   - `<БУКВА_ДИСКА>` — заглавная латинская буква, которая не используется другими дисками.

{/tab}

{/tabs}

### {heading(Linux)[id=mount_fs_linux]}

{tabs}

{tab(Протокол NFS)}

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-win) к виртуальной машине VK Cloud.

1. Установите пакет для работы с протоколом NFS:

   {tabs}
   {tab(apt)}

   ```console
   sudo apt-get install nfs-common
   ```
   {/tab}
   {tab(dnf)}

   ```console
   sudo dnf install nfs-utils
   ```
   {/tab}
   {/tabs}

2. Создайте директорию для монтирования хранилища:

   ```console
   mkdir <ИМЯ_ДИРЕКТОРИИ>
   ```

3. Подключите файловое хранилище:

   ```console
   mount -t nfs <ТОЧКА_ПОДКЛЮЧЕНИЯ> ./<ИМЯ_ДИРЕКТОРИИ>
   ```

   Здесь:

   - `<ТОЧКА_ПОДКЛЮЧЕНИЯ>` — адрес файлового хранилища. Чтобы узнать его, [посмотрите](../fs-operations#prosmotr_informacii_o_faylovom_hranilishche) информацию о файловом хранилище.
   - `<ИМЯ_ДИРЕКТОРИИ>` — имя директории, созданной ранее.

{/tab}

{tab(Протокол CIFS)}

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-win) к виртуальной машине VK Cloud.

1. Установите пакет для работы с протоколом CIFS:

   {tabs}
   {tab(apt)}

   ```console
   sudo apt install -y cifs-utils
   ```
   {/tab}
   {tab(dnf)}

   ```console
   sudo dnf install cifs-utils
   ```
   {/tab}
   {/tabs}

2. Создайте директорию для монтирования хранилища:

    ```console
    mkdir <ИМЯ_ДИРЕКТОРИИ>
    ```

3. Подключите файловое хранилище:

    ```console
    sudo mount -o user=,password= -t cifs <ТОЧКА_ПОДКЛЮЧЕНИЯ> ./<ИМЯ_ДИРЕКТОРИИ>
    ```

    Здесь:

    - `<ТОЧКА_ПОДКЛЮЧЕНИЯ>` — адрес файлового хранилища. Чтобы узнать его, [посмотрите](../fs-operations#prosmotr_informacii_o_faylovom_hranilishche) информацию о файловом хранилище.
    - `<ИМЯ_ДИРЕКТОРИИ>` — имя директории, созданной ранее.

{/tab}

{/tabs}


## {heading(Отключение файлового хранилища)[id=unmount_file_storage]}

Способ отключения файлового хранилища зависит от операционной системы виртуальной машины и протокола, выбранного при создании хранилища.

{tabs}

{tab(Windows)}

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-win) к виртуальной машине VK Cloud.

1. Отключите файловое хранилище, выполнив команду:

   {tabs}
   
   {tab(Протокол NFS)}
   
   ```console
   umount <БУКВА_ДИСКА>:
   ```
   
   {/tab}
   {tab(Протокол CIFS)}
   
   ```console
   net use <БУКВА_ДИСКА>: /delete
   ```
   
   {/tab}
   
   {/tabs}

{/tab}

{tab(Linux)}

1. [Подключитесь](/ru/computing/iaas/instructions/vm/vm-connect/vm-connect-nix) к виртуальной машине VK Cloud.

1. Отключите файловое хранилище, выполнив команду:

   {tabs}
   
   {tab(Протоколы NFS/CIFS)}
   
      ```console
      sudo umount <ТОЧКА_МОНТИРОВАНИЯ>
      ```
   Здесь `<ТОЧКА_МОНТИРОВАНИЯ>` — директория, в которую монтировано файловое хранилище.
   {/tab}
   
   {/tabs}

{note:info}
После перезагрузки ВМ система автоматически монтирует файловые хранилища, указанные в конфигурационном файле `/etc/fstab`. Чтобы этого не произошло, удалите из файла `/etc/fstab` запись об этом файловом хранилище.
{/note}

{/tab}

{/tabs}